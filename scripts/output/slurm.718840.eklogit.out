slurmstepd-eklogit: error: Unable to create TMPDIR [/tmp/user/32202]: Permission denied
slurmstepd-eklogit: error: Setting TMPDIR to /tmp
/home/g/grimmj/miniconda3/envs/idiom/lib/python3.12/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
Loaded pretrained model EleutherAI/pythia-1.4b into HookedTransformer
Running on device cuda.
Map:   0%|          | 0/2761 [00:00<?, ? examples/s]Map:   0%|          | 1/2761 [00:01<1:02:01,  1.35s/ examples]Map:   0%|          | 2/2761 [00:01<29:51,  1.54 examples/s]  Map:   0%|          | 4/2761 [00:01<13:34,  3.38 examples/s]Map:   0%|          | 6/2761 [00:01<08:46,  5.23 examples/s]Map:   0%|          | 8/2761 [00:01<06:34,  6.98 examples/s]Map:   0%|          | 10/2761 [00:02<05:21,  8.55 examples/s]Map:   0%|          | 12/2761 [00:02<04:40,  9.81 examples/s]Map:   1%|          | 14/2761 [00:02<04:17, 10.67 examples/s]Map:   1%|          | 16/2761 [00:02<04:00, 11.40 examples/s]Map:   1%|          | 18/2761 [00:02<04:39,  9.81 examples/s]Map:   1%|          | 20/2761 [00:02<04:15, 10.72 examples/s]Map:   1%|          | 22/2761 [00:03<03:59, 11.45 examples/s]Map:   1%|          | 24/2761 [00:03<03:48, 11.98 examples/s]Map:   1%|          | 26/2761 [00:03<03:40, 12.41 examples/s]Map:   1%|          | 28/2761 [00:03<03:32, 12.83 examples/s]Map:   1%|          | 30/2761 [00:03<03:30, 12.97 examples/s]Map:   1%|          | 32/2761 [00:03<03:30, 12.98 examples/s]Map:   1%|          | 34/2761 [00:04<03:28, 13.06 examples/s]Map:   1%|▏         | 36/2761 [00:04<03:29, 13.02 examples/s]Map:   1%|▏         | 38/2761 [00:04<03:42, 12.25 examples/s]Map:   1%|▏         | 40/2761 [00:04<04:25, 10.27 examples/s]Map:   2%|▏         | 42/2761 [00:04<04:07, 10.98 examples/s]Map:   2%|▏         | 44/2761 [00:04<03:51, 11.72 examples/s]Map:   2%|▏         | 46/2761 [00:05<03:46, 12.00 examples/s]Map:   2%|▏         | 48/2761 [00:05<03:43, 12.12 examples/s]Map:   2%|▏         | 50/2761 [00:05<03:43, 12.13 examples/s]Map:   2%|▏         | 52/2761 [00:05<03:46, 11.95 examples/s]Map:   2%|▏         | 54/2761 [00:05<03:39, 12.31 examples/s]Map:   2%|▏         | 56/2761 [00:05<03:39, 12.30 examples/s]Map:   2%|▏         | 58/2761 [00:06<03:40, 12.25 examples/s]Map:   2%|▏         | 60/2761 [00:06<03:39, 12.31 examples/s]Map:   2%|▏         | 62/2761 [00:06<04:59,  9.00 examples/s]Map:   2%|▏         | 64/2761 [00:06<04:34,  9.81 examples/s]Map:   2%|▏         | 66/2761 [00:06<04:19, 10.38 examples/s]Map:   2%|▏         | 68/2761 [00:07<04:06, 10.91 examples/s]Map:   3%|▎         | 70/2761 [00:07<03:58, 11.27 examples/s]Map:   3%|▎         | 72/2761 [00:07<03:49, 11.70 examples/s]Map:   3%|▎         | 74/2761 [00:07<03:45, 11.92 examples/s]Map:   3%|▎         | 76/2761 [00:07<03:42, 12.06 examples/s]Map:   3%|▎         | 78/2761 [00:07<03:41, 12.12 examples/s]Map:   3%|▎         | 80/2761 [00:08<03:35, 12.43 examples/s]Map:   3%|▎         | 82/2761 [00:08<03:35, 12.43 examples/s]Map:   3%|▎         | 84/2761 [00:08<04:21, 10.24 examples/s]Map:   3%|▎         | 86/2761 [00:08<04:04, 10.94 examples/s]Map:   3%|▎         | 88/2761 [00:08<03:52, 11.52 examples/s]Map:   3%|▎         | 90/2761 [00:08<03:46, 11.78 examples/s]Map:   3%|▎         | 92/2761 [00:09<03:42, 11.99 examples/s]Map:   3%|▎         | 94/2761 [00:09<03:41, 12.05 examples/s]Map:   3%|▎         | 96/2761 [00:09<03:40, 12.11 examples/s]Map:   4%|▎         | 98/2761 [00:09<03:35, 12.34 examples/s]Map:   4%|▎         | 100/2761 [00:09<03:35, 12.34 examples/s]Map:   4%|▎         | 102/2761 [00:09<03:31, 12.56 examples/s]Map:   4%|▍         | 104/2761 [00:10<03:33, 12.44 examples/s]Map:   4%|▍         | 106/2761 [00:10<04:17, 10.29 examples/s]Map:   4%|▍         | 108/2761 [00:10<04:01, 10.98 examples/s]Map:   4%|▍         | 110/2761 [00:10<03:45, 11.74 examples/s]Map:   4%|▍         | 112/2761 [00:10<03:39, 12.08 examples/s]Map:   4%|▍         | 114/2761 [00:10<03:39, 12.06 examples/s]Map:   4%|▍         | 116/2761 [00:11<03:35, 12.25 examples/s]Map:   4%|▍         | 118/2761 [00:11<03:37, 12.14 examples/s]Map:   4%|▍         | 120/2761 [00:11<03:53, 11.29 examples/s]Map:   4%|▍         | 122/2761 [00:11<03:45, 11.70 examples/s]Map:   4%|▍         | 124/2761 [00:11<03:37, 12.13 examples/s]Map:   5%|▍         | 126/2761 [00:11<03:32, 12.39 examples/s]Map:   5%|▍         | 128/2761 [00:12<04:13, 10.37 examples/s]Map:   5%|▍         | 130/2761 [00:12<04:02, 10.84 examples/s]Map:   5%|▍         | 132/2761 [00:12<04:09, 10.52 examples/s]Map:   5%|▍         | 134/2761 [00:12<04:11, 10.43 examples/s]Map:   5%|▍         | 136/2761 [00:12<04:02, 10.82 examples/s]Map:   5%|▍         | 138/2761 [00:13<03:49, 11.41 examples/s]Map:   5%|▌         | 140/2761 [00:13<03:46, 11.59 examples/s]Map:   5%|▌         | 142/2761 [00:13<03:43, 11.73 examples/s]Map:   5%|▌         | 144/2761 [00:13<03:40, 11.85 examples/s]Map:   5%|▌         | 146/2761 [00:13<03:41, 11.80 examples/s]Map:   5%|▌         | 148/2761 [00:13<03:39, 11.90 examples/s]Map:   5%|▌         | 150/2761 [00:14<04:19, 10.04 examples/s]Map:   6%|▌         | 152/2761 [00:14<04:09, 10.46 examples/s]Map:   6%|▌         | 154/2761 [00:14<04:01, 10.81 examples/s]Map:   6%|▌         | 156/2761 [00:14<03:49, 11.37 examples/s]Map:   6%|▌         | 158/2761 [00:14<03:44, 11.61 examples/s]Map:   6%|▌         | 160/2761 [00:15<03:41, 11.76 examples/s]Map:   6%|▌         | 162/2761 [00:15<03:38, 11.90 examples/s]Map:   6%|▌         | 164/2761 [00:15<03:36, 12.01 examples/s]Map:   6%|▌         | 166/2761 [00:15<03:34, 12.08 examples/s]Map:   6%|▌         | 168/2761 [00:15<03:33, 12.14 examples/s]Map:   6%|▌         | 170/2761 [00:15<03:33, 12.16 examples/s]Map:   6%|▌         | 172/2761 [00:16<04:14, 10.18 examples/s]Map:   6%|▋         | 174/2761 [00:16<04:01, 10.69 examples/s]Map:   6%|▋         | 176/2761 [00:16<03:48, 11.30 examples/s]Map:   6%|▋         | 178/2761 [00:16<04:01, 10.67 examples/s]Map:   7%|▋         | 180/2761 [00:16<03:51, 11.13 examples/s]Map:   7%|▋         | 182/2761 [00:16<03:46, 11.40 examples/s]Map:   7%|▋         | 184/2761 [00:17<03:42, 11.58 examples/s]Map:   7%|▋         | 186/2761 [00:17<03:39, 11.73 examples/s]Map:   7%|▋         | 188/2761 [00:17<03:38, 11.80 examples/s]Map:   7%|▋         | 190/2761 [00:17<03:36, 11.88 examples/s]Map:   7%|▋         | 192/2761 [00:17<03:35, 11.89 examples/s]Map:   7%|▋         | 194/2761 [00:18<04:11, 10.21 examples/s]Map:   7%|▋         | 196/2761 [00:18<04:02, 10.59 examples/s]Map:   7%|▋         | 198/2761 [00:18<03:51, 11.06 examples/s]Map:   7%|▋         | 200/2761 [00:18<03:41, 11.58 examples/s]Map:   7%|▋         | 202/2761 [00:18<03:34, 11.95 examples/s]Map:   7%|▋         | 204/2761 [00:18<03:32, 12.02 examples/s]Map:   7%|▋         | 206/2761 [00:19<03:33, 11.97 examples/s]Map:   8%|▊         | 208/2761 [00:19<03:31, 12.06 examples/s]Map:   8%|▊         | 210/2761 [00:19<03:28, 12.25 examples/s]Map:   8%|▊         | 212/2761 [00:19<03:30, 12.09 examples/s]Map:   8%|▊         | 214/2761 [00:19<03:32, 11.97 examples/s]Map:   8%|▊         | 216/2761 [00:19<04:10, 10.18 examples/s]Map:   8%|▊         | 218/2761 [00:20<03:53, 10.87 examples/s]Map:   8%|▊         | 220/2761 [00:20<03:47, 11.17 examples/s]Map:   8%|▊         | 222/2761 [00:20<03:46, 11.20 examples/s]Map:   8%|▊         | 224/2761 [00:20<03:38, 11.61 examples/s]Map:   8%|▊         | 226/2761 [00:20<03:34, 11.80 examples/s]Map:   8%|▊         | 228/2761 [00:20<03:35, 11.74 examples/s]Map:   8%|▊         | 230/2761 [00:21<03:33, 11.84 examples/s]Map:   8%|▊         | 232/2761 [00:21<03:33, 11.86 examples/s]Map:   8%|▊         | 234/2761 [00:21<03:32, 11.89 examples/s]Map:   9%|▊         | 236/2761 [00:21<03:51, 10.91 examples/s]Map:   9%|▊         | 238/2761 [00:21<04:22,  9.62 examples/s]Map:   9%|▊         | 240/2761 [00:22<04:06, 10.22 examples/s]Map:   9%|▉         | 242/2761 [00:22<03:54, 10.74 examples/s]Map:   9%|▉         | 244/2761 [00:22<03:46, 11.10 examples/s]Map:   9%|▉         | 246/2761 [00:22<03:37, 11.58 examples/s]Map:   9%|▉         | 248/2761 [00:22<03:34, 11.73 examples/s]Map:   9%|▉         | 250/2761 [00:22<03:32, 11.79 examples/s]Map:   9%|▉         | 252/2761 [00:23<03:31, 11.84 examples/s]Map:   9%|▉         | 254/2761 [00:23<03:32, 11.81 examples/s]Map:   9%|▉         | 256/2761 [00:23<03:30, 11.88 examples/s]Map:   9%|▉         | 258/2761 [00:23<03:30, 11.90 examples/s]Map:   9%|▉         | 260/2761 [00:23<04:11,  9.96 examples/s]Map:   9%|▉         | 262/2761 [00:24<03:58, 10.49 examples/s]Map:  10%|▉         | 264/2761 [00:24<03:48, 10.94 examples/s]Map:  10%|▉         | 266/2761 [00:24<03:43, 11.15 examples/s]Map:  10%|▉         | 268/2761 [00:24<03:39, 11.37 examples/s]Map:  10%|▉         | 270/2761 [00:24<03:35, 11.53 examples/s]Map:  10%|▉         | 272/2761 [00:24<03:33, 11.65 examples/s]Map:  10%|▉         | 274/2761 [00:25<03:30, 11.83 examples/s]Map:  10%|▉         | 276/2761 [00:25<03:27, 11.98 examples/s]Map:  10%|█         | 278/2761 [00:25<03:27, 11.96 examples/s]Map:  10%|█         | 280/2761 [00:25<03:27, 11.96 examples/s]Map:  10%|█         | 282/2761 [00:25<04:07, 10.03 examples/s]Map:  10%|█         | 284/2761 [00:25<03:54, 10.56 examples/s]Map:  10%|█         | 286/2761 [00:26<03:48, 10.85 examples/s]Map:  10%|█         | 288/2761 [00:26<03:41, 11.15 examples/s]Map:  11%|█         | 290/2761 [00:26<03:37, 11.36 examples/s]Map:  11%|█         | 292/2761 [00:26<03:51, 10.68 examples/s]Map:  11%|█         | 294/2761 [00:26<03:43, 11.04 examples/s]Map:  11%|█         | 296/2761 [00:27<03:39, 11.22 examples/s]Map:  11%|█         | 298/2761 [00:27<03:35, 11.41 examples/s]Map:  11%|█         | 300/2761 [00:27<03:31, 11.66 examples/s]Map:  11%|█         | 302/2761 [00:27<03:30, 11.70 examples/s]Map:  11%|█         | 304/2761 [00:27<04:11,  9.77 examples/s]Map:  11%|█         | 306/2761 [00:28<04:02, 10.12 examples/s]Map:  11%|█         | 308/2761 [00:28<03:52, 10.56 examples/s]Map:  11%|█         | 310/2761 [00:28<03:44, 10.93 examples/s]Map:  11%|█▏        | 312/2761 [00:28<03:39, 11.18 examples/s]Map:  11%|█▏        | 314/2761 [00:28<03:34, 11.41 examples/s]Map:  11%|█▏        | 316/2761 [00:28<03:30, 11.60 examples/s]Map:  12%|█▏        | 318/2761 [00:29<03:27, 11.75 examples/s]Map:  12%|█▏        | 320/2761 [00:29<03:24, 11.93 examples/s]Map:  12%|█▏        | 322/2761 [00:29<03:24, 11.91 examples/s]Map:  12%|█▏        | 324/2761 [00:29<03:26, 11.82 examples/s]Map:  12%|█▏        | 326/2761 [00:29<04:06,  9.86 examples/s]Map:  12%|█▏        | 328/2761 [00:29<03:50, 10.55 examples/s]Map:  12%|█▏        | 330/2761 [00:30<03:42, 10.92 examples/s]Map:  12%|█▏        | 332/2761 [00:30<03:38, 11.10 examples/s]Map:  12%|█▏        | 334/2761 [00:30<03:33, 11.38 examples/s]Map:  12%|█▏        | 336/2761 [00:30<03:30, 11.53 examples/s]Map:  12%|█▏        | 338/2761 [00:30<03:27, 11.67 examples/s]Map:  12%|█▏        | 340/2761 [00:30<03:22, 11.93 examples/s]Map:  12%|█▏        | 342/2761 [00:31<03:23, 11.91 examples/s]Map:  12%|█▏        | 344/2761 [00:31<03:19, 12.11 examples/s]Map:  13%|█▎        | 346/2761 [00:31<03:23, 11.88 examples/s]Map:  13%|█▎        | 348/2761 [00:31<04:20,  9.27 examples/s]Map:  13%|█▎        | 350/2761 [00:31<04:03,  9.89 examples/s]Map:  13%|█▎        | 352/2761 [00:32<03:51, 10.40 examples/s]Map:  13%|█▎        | 354/2761 [00:32<03:39, 10.98 examples/s]Map:  13%|█▎        | 356/2761 [00:32<03:34, 11.19 examples/s]Map:  13%|█▎        | 358/2761 [00:32<03:30, 11.40 examples/s]Map:  13%|█▎        | 360/2761 [00:32<03:32, 11.28 examples/s]Map:  13%|█▎        | 362/2761 [00:32<03:29, 11.45 examples/s]Map:  13%|█▎        | 364/2761 [00:33<03:27, 11.56 examples/s]Map:  13%|█▎        | 366/2761 [00:33<03:26, 11.59 examples/s]Map:  13%|█▎        | 368/2761 [00:33<03:29, 11.40 examples/s]Map:  13%|█▎        | 370/2761 [00:33<04:07,  9.66 examples/s]Map:  13%|█▎        | 372/2761 [00:33<03:53, 10.23 examples/s]Map:  14%|█▎        | 374/2761 [00:34<03:46, 10.55 examples/s]Map:  14%|█▎        | 376/2761 [00:34<03:38, 10.90 examples/s]Map:  14%|█▎        | 378/2761 [00:34<03:30, 11.30 examples/s]Map:  14%|█▍        | 380/2761 [00:34<03:29, 11.35 examples/s]Map:  14%|█▍        | 382/2761 [00:34<03:28, 11.42 examples/s]Map:  14%|█▍        | 384/2761 [00:34<03:27, 11.48 examples/s]Map:  14%|█▍        | 386/2761 [00:35<03:26, 11.48 examples/s]Map:  14%|█▍        | 388/2761 [00:35<03:24, 11.61 examples/s]Map:  14%|█▍        | 390/2761 [00:35<03:22, 11.70 examples/s]Map:  14%|█▍        | 392/2761 [00:35<04:01,  9.80 examples/s]Map:  14%|█▍        | 394/2761 [00:35<03:47, 10.39 examples/s]Map:  14%|█▍        | 396/2761 [00:36<03:40, 10.74 examples/s]Map:  14%|█▍        | 398/2761 [00:36<03:35, 10.96 examples/s]Map:  14%|█▍        | 400/2761 [00:36<03:32, 11.10 examples/s]Map:  15%|█▍        | 402/2761 [00:36<03:28, 11.33 examples/s]Map:  15%|█▍        | 404/2761 [00:36<03:47, 10.37 examples/s]Map:  15%|█▍        | 406/2761 [00:37<03:40, 10.68 examples/s]Map:  15%|█▍        | 408/2761 [00:37<03:33, 11.01 examples/s]Map:  15%|█▍        | 410/2761 [00:37<03:25, 11.46 examples/s]Map:  15%|█▍        | 412/2761 [00:37<03:22, 11.61 examples/s]Map:  15%|█▍        | 414/2761 [00:37<03:17, 11.91 examples/s]Map:  15%|█▌        | 416/2761 [00:37<03:56,  9.93 examples/s]Map:  15%|█▌        | 418/2761 [00:38<03:46, 10.35 examples/s]Map:  15%|█▌        | 420/2761 [00:38<03:37, 10.75 examples/s]Map:  15%|█▌        | 422/2761 [00:38<03:33, 10.97 examples/s]Map:  15%|█▌        | 424/2761 [00:38<03:29, 11.18 examples/s]Map:  15%|█▌        | 426/2761 [00:38<03:23, 11.45 examples/s]Map:  16%|█▌        | 428/2761 [00:38<03:22, 11.52 examples/s]Map:  16%|█▌        | 430/2761 [00:39<03:19, 11.67 examples/s]Map:  16%|█▌        | 432/2761 [00:39<03:17, 11.78 examples/s]Map:  16%|█▌        | 434/2761 [00:39<03:17, 11.76 examples/s]Map:  16%|█▌        | 436/2761 [00:39<03:17, 11.79 examples/s]Map:  16%|█▌        | 438/2761 [00:39<03:55,  9.88 examples/s]Map:  16%|█▌        | 440/2761 [00:40<03:42, 10.41 examples/s]Map:  16%|█▌        | 442/2761 [00:40<03:35, 10.74 examples/s]Map:  16%|█▌        | 444/2761 [00:40<03:29, 11.04 examples/s]Map:  16%|█▌        | 446/2761 [00:40<03:29, 11.05 examples/s]Map:  16%|█▌        | 448/2761 [00:40<03:24, 11.30 examples/s]Map:  16%|█▋        | 450/2761 [00:40<03:22, 11.40 examples/s]Map:  16%|█▋        | 452/2761 [00:41<03:20, 11.53 examples/s]Map:  16%|█▋        | 454/2761 [00:41<03:18, 11.65 examples/s]Map:  17%|█▋        | 456/2761 [00:41<03:16, 11.71 examples/s]Map:  17%|█▋        | 458/2761 [00:41<03:15, 11.75 examples/s]Map:  17%|█▋        | 460/2761 [00:41<03:36, 10.61 examples/s]Map:  17%|█▋        | 462/2761 [00:42<04:09,  9.20 examples/s]Map:  17%|█▋        | 464/2761 [00:42<03:53,  9.84 examples/s]Map:  17%|█▋        | 466/2761 [00:42<03:41, 10.36 examples/s]Map:  17%|█▋        | 468/2761 [00:42<03:32, 10.80 examples/s]Map:  17%|█▋        | 470/2761 [00:42<03:23, 11.28 examples/s]Map:  17%|█▋        | 472/2761 [00:42<03:20, 11.41 examples/s]Map:  17%|█▋        | 474/2761 [00:43<03:20, 11.42 examples/s]Map:  17%|█▋        | 476/2761 [00:43<03:17, 11.58 examples/s]Map:  17%|█▋        | 478/2761 [00:43<03:15, 11.66 examples/s]Map:  17%|█▋        | 480/2761 [00:43<03:14, 11.75 examples/s]Map:  17%|█▋        | 482/2761 [00:43<03:15, 11.65 examples/s]Map:  18%|█▊        | 484/2761 [00:44<03:53,  9.74 examples/s]Map:  18%|█▊        | 486/2761 [00:44<03:42, 10.20 examples/s]Map:  18%|█▊        | 488/2761 [00:44<03:33, 10.66 examples/s]Map:  18%|█▊        | 490/2761 [00:44<03:27, 10.92 examples/s]Map:  18%|█▊        | 492/2761 [00:44<03:22, 11.19 examples/s]Map:  18%|█▊        | 494/2761 [00:44<03:21, 11.22 examples/s]Map:  18%|█▊        | 496/2761 [00:45<03:19, 11.35 examples/s]Map:  18%|█▊        | 498/2761 [00:45<03:19, 11.37 examples/s]Map:  18%|█▊        | 500/2761 [00:45<03:16, 11.49 examples/s]Map:  18%|█▊        | 502/2761 [00:45<03:15, 11.53 examples/s]Map:  18%|█▊        | 504/2761 [00:45<03:15, 11.57 examples/s]Map:  18%|█▊        | 506/2761 [00:46<03:13, 11.63 examples/s]Map:  18%|█▊        | 508/2761 [00:46<03:51,  9.72 examples/s]Map:  18%|█▊        | 510/2761 [00:46<03:43, 10.07 examples/s]Map:  19%|█▊        | 512/2761 [00:46<03:36, 10.40 examples/s]Map:  19%|█▊        | 514/2761 [00:46<03:48,  9.83 examples/s]Map:  19%|█▊        | 516/2761 [00:47<03:41, 10.13 examples/s]Map:  19%|█▉        | 518/2761 [00:47<03:32, 10.57 examples/s]Map:  19%|█▉        | 520/2761 [00:47<03:27, 10.82 examples/s]Map:  19%|█▉        | 522/2761 [00:47<03:25, 10.91 examples/s]Map:  19%|█▉        | 524/2761 [00:47<03:23, 11.00 examples/s]Map:  19%|█▉        | 526/2761 [00:47<03:18, 11.24 examples/s]Map:  19%|█▉        | 528/2761 [00:48<03:15, 11.42 examples/s]Map:  19%|█▉        | 530/2761 [00:48<03:50,  9.67 examples/s]Map:  19%|█▉        | 532/2761 [00:48<03:41, 10.06 examples/s]Map:  19%|█▉        | 534/2761 [00:48<03:33, 10.45 examples/s]Map:  19%|█▉        | 536/2761 [00:48<03:26, 10.79 examples/s]Map:  19%|█▉        | 538/2761 [00:49<03:21, 11.03 examples/s]Map:  20%|█▉        | 540/2761 [00:49<03:20, 11.09 examples/s]Map:  20%|█▉        | 542/2761 [00:49<03:18, 11.16 examples/s]Map:  20%|█▉        | 544/2761 [00:49<03:16, 11.26 examples/s]Map:  20%|█▉        | 546/2761 [00:49<03:15, 11.36 examples/s]Map:  20%|█▉        | 548/2761 [00:49<03:14, 11.39 examples/s]Map:  20%|█▉        | 550/2761 [00:50<03:14, 11.35 examples/s]Map:  20%|█▉        | 552/2761 [00:50<03:16, 11.26 examples/s]Map:  20%|██        | 554/2761 [00:50<03:52,  9.50 examples/s]Map:  20%|██        | 556/2761 [00:50<03:39, 10.05 examples/s]Map:  20%|██        | 558/2761 [00:50<03:29, 10.50 examples/s]Map:  20%|██        | 560/2761 [00:51<03:24, 10.78 examples/s]Map:  20%|██        | 562/2761 [00:51<03:20, 10.99 examples/s]Map:  20%|██        | 564/2761 [00:51<03:18, 11.05 examples/s]Map:  20%|██        | 566/2761 [00:51<03:18, 11.07 examples/s]Map:  21%|██        | 568/2761 [00:51<03:35, 10.17 examples/s]Map:  21%|██        | 570/2761 [00:52<03:27, 10.54 examples/s]Map:  21%|██        | 572/2761 [00:52<03:21, 10.86 examples/s]Map:  21%|██        | 574/2761 [00:52<03:20, 10.90 examples/s]Map:  21%|██        | 576/2761 [00:52<03:54,  9.33 examples/s]Map:  21%|██        | 578/2761 [00:52<03:41,  9.84 examples/s]Map:  21%|██        | 580/2761 [00:53<03:32, 10.28 examples/s]Map:  21%|██        | 582/2761 [00:53<03:25, 10.60 examples/s]Map:  21%|██        | 584/2761 [00:53<03:21, 10.81 examples/s]Map:  21%|██        | 586/2761 [00:53<03:17, 11.00 examples/s]Map:  21%|██▏       | 588/2761 [00:53<03:15, 11.14 examples/s]Map:  21%|██▏       | 590/2761 [00:53<03:13, 11.21 examples/s]Map:  21%|██▏       | 592/2761 [00:54<03:14, 11.17 examples/s]Map:  22%|██▏       | 594/2761 [00:54<03:12, 11.24 examples/s]Map:  22%|██▏       | 596/2761 [00:54<03:12, 11.26 examples/s]Map:  22%|██▏       | 598/2761 [00:54<03:13, 11.19 examples/s]Map:  22%|██▏       | 600/2761 [00:54<03:48,  9.45 examples/s]Map:  22%|██▏       | 602/2761 [00:55<03:39,  9.85 examples/s]Map:  22%|██▏       | 604/2761 [00:55<03:30, 10.27 examples/s]Map:  22%|██▏       | 606/2761 [00:55<03:27, 10.40 examples/s]Map:  22%|██▏       | 608/2761 [00:55<03:25, 10.49 examples/s]Map:  22%|██▏       | 610/2761 [00:55<03:21, 10.69 examples/s]Map:  22%|██▏       | 612/2761 [00:56<03:19, 10.79 examples/s]Map:  22%|██▏       | 614/2761 [00:56<03:22, 10.58 examples/s]Map:  22%|██▏       | 616/2761 [00:56<03:26, 10.40 examples/s]Map:  22%|██▏       | 618/2761 [00:56<03:27, 10.35 examples/s]Map:  22%|██▏       | 620/2761 [00:56<03:42,  9.62 examples/s]Map:  23%|██▎       | 622/2761 [00:57<04:08,  8.60 examples/s]Map:  23%|██▎       | 624/2761 [00:57<03:51,  9.24 examples/s]Map:  23%|██▎       | 626/2761 [00:57<03:39,  9.73 examples/s]Map:  23%|██▎       | 628/2761 [00:57<03:34,  9.96 examples/s]Map:  23%|██▎       | 630/2761 [00:57<03:28, 10.24 examples/s]Map:  23%|██▎       | 632/2761 [00:58<03:21, 10.55 examples/s]Map:  23%|██▎       | 634/2761 [00:58<03:18, 10.74 examples/s]Map:  23%|██▎       | 636/2761 [00:58<03:14, 10.90 examples/s]Map:  23%|██▎       | 638/2761 [00:58<03:13, 10.96 examples/s]Map:  23%|██▎       | 640/2761 [00:58<03:12, 11.00 examples/s]Map:  23%|██▎       | 642/2761 [00:58<03:14, 10.92 examples/s]Map:  23%|██▎       | 644/2761 [00:59<03:12, 11.02 examples/s]Map:  23%|██▎       | 646/2761 [00:59<03:44,  9.41 examples/s]Map:  23%|██▎       | 648/2761 [00:59<03:33,  9.89 examples/s]Map:  24%|██▎       | 650/2761 [00:59<03:25, 10.27 examples/s]Map:  24%|██▎       | 652/2761 [00:59<03:20, 10.53 examples/s]Map:  24%|██▎       | 654/2761 [01:00<03:14, 10.85 examples/s]Map:  24%|██▍       | 656/2761 [01:00<03:11, 10.98 examples/s]Map:  24%|██▍       | 658/2761 [01:00<03:11, 11.01 examples/s]Map:  24%|██▍       | 660/2761 [01:00<03:09, 11.11 examples/s]Map:  24%|██▍       | 662/2761 [01:00<03:08, 11.13 examples/s]Map:  24%|██▍       | 664/2761 [01:01<03:08, 11.12 examples/s]Map:  24%|██▍       | 666/2761 [01:01<03:07, 11.19 examples/s]Map:  24%|██▍       | 668/2761 [01:01<03:42,  9.39 examples/s]Map:  24%|██▍       | 670/2761 [01:01<03:30,  9.92 examples/s]Map:  24%|██▍       | 672/2761 [01:01<03:47,  9.17 examples/s]Map:  24%|██▍       | 674/2761 [01:02<03:33,  9.76 examples/s]Map:  24%|██▍       | 676/2761 [01:02<03:22, 10.28 examples/s]Map:  25%|██▍       | 678/2761 [01:02<03:14, 10.73 examples/s]Map:  25%|██▍       | 680/2761 [01:02<03:09, 11.00 examples/s]Map:  25%|██▍       | 682/2761 [01:02<03:07, 11.09 examples/s]Map:  25%|██▍       | 684/2761 [01:02<03:04, 11.29 examples/s]Map:  25%|██▍       | 686/2761 [01:03<03:01, 11.45 examples/s]Map:  25%|██▍       | 687/2761 [01:03<03:11, 10.84 examples/s]
Traceback (most recent call last):
  File "/home/g/grimmj/IdiomHeads/compute_idiom_mean.py", line 57, in <module>
    data.map(lambda batch: scorer.compute_mean_batched(batch, ckp_file), batched=True, batch_size = batch_size)
  File "/home/g/grimmj/miniconda3/envs/idiom/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 562, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
                                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/g/grimmj/miniconda3/envs/idiom/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 3079, in map
    for rank, done, content in Dataset._map_single(**dataset_kwargs):
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/g/grimmj/miniconda3/envs/idiom/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 3519, in _map_single
    for i, batch in iter_outputs(shard_iterable):
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/g/grimmj/miniconda3/envs/idiom/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 3469, in iter_outputs
    yield i, apply_function(example, i, offset=offset)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/g/grimmj/miniconda3/envs/idiom/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 3392, in apply_function
    processed_inputs = function(*fn_args, *additional_args, **fn_kwargs)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/g/grimmj/IdiomHeads/compute_idiom_mean.py", line 57, in <lambda>
    data.map(lambda batch: scorer.compute_mean_batched(batch, ckp_file), batched=True, batch_size = batch_size)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/g/grimmj/IdiomHeads/idiom_score.py", line 298, in compute_mean_batched
    cache = self.get_cache(sent)
            ^^^^^^^^^^^^^^^^^^^^
  File "/home/g/grimmj/IdiomHeads/idiom_score.py", line 42, in get_cache
    logits, cache = self.model.run_with_cache(idiom_tokens, remove_batch_dim=True)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/g/grimmj/miniconda3/envs/idiom/lib/python3.12/site-packages/transformer_lens/HookedTransformer.py", line 694, in run_with_cache
    out, cache_dict = super().run_with_cache(
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/g/grimmj/miniconda3/envs/idiom/lib/python3.12/site-packages/transformer_lens/hook_points.py", line 569, in run_with_cache
    model_out = self(*model_args, **model_kwargs)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/g/grimmj/miniconda3/envs/idiom/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/g/grimmj/miniconda3/envs/idiom/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/g/grimmj/miniconda3/envs/idiom/lib/python3.12/site-packages/transformer_lens/HookedTransformer.py", line 612, in forward
    residual = block(
               ^^^^^^
  File "/home/g/grimmj/miniconda3/envs/idiom/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/g/grimmj/miniconda3/envs/idiom/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/g/grimmj/miniconda3/envs/idiom/lib/python3.12/site-packages/transformer_lens/components/transformer_block.py", line 194, in forward
    mlp_out = self.apply_mlp(normalized_resid_pre_2)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/g/grimmj/miniconda3/envs/idiom/lib/python3.12/site-packages/transformer_lens/components/transformer_block.py", line 210, in apply_mlp
    mlp_out = self.mlp(normalized_resid)  # [batch, pos, d_model]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/g/grimmj/miniconda3/envs/idiom/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/g/grimmj/miniconda3/envs/idiom/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/g/grimmj/miniconda3/envs/idiom/lib/python3.12/site-packages/transformer_lens/components/mlps/mlp.py", line 38, in forward
    pre_act = self.hook_pre(batch_addmm(self.b_in, self.W_in, x))  # [batch, pos, d_mlp]
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/g/grimmj/miniconda3/envs/idiom/lib/python3.12/site-packages/transformer_lens/utilities/addmm.py", line 33, in batch_addmm
    x = vanilla_addmm(bias, x.view(-1, x.size(-1)), weight)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/g/grimmj/miniconda3/envs/idiom/lib/python3.12/site-packages/transformer_lens/utilities/addmm.py", line 18, in vanilla_addmm
    return torch.addmm(input, mat1, mat2)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 20.00 MiB. GPU 0 has a total capacity of 7.77 GiB of which 8.81 MiB is free. Including non-PyTorch memory, this process has 7.59 GiB memory in use. Of the allocated memory 7.45 GiB is allocated by PyTorch, and 33.56 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
