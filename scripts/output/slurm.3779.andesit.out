slurmstepd-andesit: error: Unable to create TMPDIR [/tmp/user/32202]: Permission denied
slurmstepd-andesit: error: Setting TMPDIR to /tmp
WARNING:root:float16 models may not work on CPU. Consider using a GPU or bfloat16.
WARNING:root:With reduced precision, it is advised to use `from_pretrained_no_processing` instead of `from_pretrained`.
WARNING:root:You are not using LayerNorm, so the writing weights can't be centered! Skipping
Loaded pretrained model meta-llama/Llama-3.2-1B-Instruct into HookedTransformer

Model uses LayerNorm!

Running logit attribution on device cuda.

Processing split:  trans
Map:   0%|          | 0/1371 [00:00<?, ? examples/s]
Computing logit attribution for the following components:
['L0H0', 'L0H1', 'L0H2', 'L0H3', 'L0H4', 'L0H5', 'L0H6', 'L0H7', 'L0H8', 'L0H9', 'L0H10', 'L0H11', 'L0H12', 'L0H13', 'L0H14', 'L0H15', 'L0H16', 'L0H17', 'L0H18', 'L0H19', 'L0H20', 'L0H21', 'L0H22', 'L0H23', 'L0H24', 'L0H25', 'L0H26', 'L0H27', 'L0H28', 'L0H29', 'L0H30', 'L0H31', 'L1H0', 'L1H1', 'L1H2', 'L1H3', 'L1H4', 'L1H5', 'L1H6', 'L1H7', 'L1H8', 'L1H9', 'L1H10', 'L1H11', 'L1H12', 'L1H13', 'L1H14', 'L1H15', 'L1H16', 'L1H17', 'L1H18', 'L1H19', 'L1H20', 'L1H21', 'L1H22', 'L1H23', 'L1H24', 'L1H25', 'L1H26', 'L1H27', 'L1H28', 'L1H29', 'L1H30', 'L1H31', 'L2H0', 'L2H1', 'L2H2', 'L2H3', 'L2H4', 'L2H5', 'L2H6', 'L2H7', 'L2H8', 'L2H9', 'L2H10', 'L2H11', 'L2H12', 'L2H13', 'L2H14', 'L2H15', 'L2H16', 'L2H17', 'L2H18', 'L2H19', 'L2H20', 'L2H21', 'L2H22', 'L2H23', 'L2H24', 'L2H25', 'L2H26', 'L2H27', 'L2H28', 'L2H29', 'L2H30', 'L2H31', 'L3H0', 'L3H1', 'L3H2', 'L3H3', 'L3H4', 'L3H5', 'L3H6', 'L3H7', 'L3H8', 'L3H9', 'L3H10', 'L3H11', 'L3H12', 'L3H13', 'L3H14', 'L3H15', 'L3H16', 'L3H17', 'L3H18', 'L3H19', 'L3H20', 'L3H21', 'L3H22', 'L3H23', 'L3H24', 'L3H25', 'L3H26', 'L3H27', 'L3H28', 'L3H29', 'L3H30', 'L3H31', 'L4H0', 'L4H1', 'L4H2', 'L4H3', 'L4H4', 'L4H5', 'L4H6', 'L4H7', 'L4H8', 'L4H9', 'L4H10', 'L4H11', 'L4H12', 'L4H13', 'L4H14', 'L4H15', 'L4H16', 'L4H17', 'L4H18', 'L4H19', 'L4H20', 'L4H21', 'L4H22', 'L4H23', 'L4H24', 'L4H25', 'L4H26', 'L4H27', 'L4H28', 'L4H29', 'L4H30', 'L4H31', 'L5H0', 'L5H1', 'L5H2', 'L5H3', 'L5H4', 'L5H5', 'L5H6', 'L5H7', 'L5H8', 'L5H9', 'L5H10', 'L5H11', 'L5H12', 'L5H13', 'L5H14', 'L5H15', 'L5H16', 'L5H17', 'L5H18', 'L5H19', 'L5H20', 'L5H21', 'L5H22', 'L5H23', 'L5H24', 'L5H25', 'L5H26', 'L5H27', 'L5H28', 'L5H29', 'L5H30', 'L5H31', 'L6H0', 'L6H1', 'L6H2', 'L6H3', 'L6H4', 'L6H5', 'L6H6', 'L6H7', 'L6H8', 'L6H9', 'L6H10', 'L6H11', 'L6H12', 'L6H13', 'L6H14', 'L6H15', 'L6H16', 'L6H17', 'L6H18', 'L6H19', 'L6H20', 'L6H21', 'L6H22', 'L6H23', 'L6H24', 'L6H25', 'L6H26', 'L6H27', 'L6H28', 'L6H29', 'L6H30', 'L6H31', 'L7H0', 'L7H1', 'L7H2', 'L7H3', 'L7H4', 'L7H5', 'L7H6', 'L7H7', 'L7H8', 'L7H9', 'L7H10', 'L7H11', 'L7H12', 'L7H13', 'L7H14', 'L7H15', 'L7H16', 'L7H17', 'L7H18', 'L7H19', 'L7H20', 'L7H21', 'L7H22', 'L7H23', 'L7H24', 'L7H25', 'L7H26', 'L7H27', 'L7H28', 'L7H29', 'L7H30', 'L7H31', 'L8H0', 'L8H1', 'L8H2', 'L8H3', 'L8H4', 'L8H5', 'L8H6', 'L8H7', 'L8H8', 'L8H9', 'L8H10', 'L8H11', 'L8H12', 'L8H13', 'L8H14', 'L8H15', 'L8H16', 'L8H17', 'L8H18', 'L8H19', 'L8H20', 'L8H21', 'L8H22', 'L8H23', 'L8H24', 'L8H25', 'L8H26', 'L8H27', 'L8H28', 'L8H29', 'L8H30', 'L8H31', 'L9H0', 'L9H1', 'L9H2', 'L9H3', 'L9H4', 'L9H5', 'L9H6', 'L9H7', 'L9H8', 'L9H9', 'L9H10', 'L9H11', 'L9H12', 'L9H13', 'L9H14', 'L9H15', 'L9H16', 'L9H17', 'L9H18', 'L9H19', 'L9H20', 'L9H21', 'L9H22', 'L9H23', 'L9H24', 'L9H25', 'L9H26', 'L9H27', 'L9H28', 'L9H29', 'L9H30', 'L9H31', 'L10H0', 'L10H1', 'L10H2', 'L10H3', 'L10H4', 'L10H5', 'L10H6', 'L10H7', 'L10H8', 'L10H9', 'L10H10', 'L10H11', 'L10H12', 'L10H13', 'L10H14', 'L10H15', 'L10H16', 'L10H17', 'L10H18', 'L10H19', 'L10H20', 'L10H21', 'L10H22', 'L10H23', 'L10H24', 'L10H25', 'L10H26', 'L10H27', 'L10H28', 'L10H29', 'L10H30', 'L10H31', 'L11H0', 'L11H1', 'L11H2', 'L11H3', 'L11H4', 'L11H5', 'L11H6', 'L11H7', 'L11H8', 'L11H9', 'L11H10', 'L11H11', 'L11H12', 'L11H13', 'L11H14', 'L11H15', 'L11H16', 'L11H17', 'L11H18', 'L11H19', 'L11H20', 'L11H21', 'L11H22', 'L11H23', 'L11H24', 'L11H25', 'L11H26', 'L11H27', 'L11H28', 'L11H29', 'L11H30', 'L11H31', 'L12H0', 'L12H1', 'L12H2', 'L12H3', 'L12H4', 'L12H5', 'L12H6', 'L12H7', 'L12H8', 'L12H9', 'L12H10', 'L12H11', 'L12H12', 'L12H13', 'L12H14', 'L12H15', 'L12H16', 'L12H17', 'L12H18', 'L12H19', 'L12H20', 'L12H21', 'L12H22', 'L12H23', 'L12H24', 'L12H25', 'L12H26', 'L12H27', 'L12H28', 'L12H29', 'L12H30', 'L12H31', 'L13H0', 'L13H1', 'L13H2', 'L13H3', 'L13H4', 'L13H5', 'L13H6', 'L13H7', 'L13H8', 'L13H9', 'L13H10', 'L13H11', 'L13H12', 'L13H13', 'L13H14', 'L13H15', 'L13H16', 'L13H17', 'L13H18', 'L13H19', 'L13H20', 'L13H21', 'L13H22', 'L13H23', 'L13H24', 'L13H25', 'L13H26', 'L13H27', 'L13H28', 'L13H29', 'L13H30', 'L13H31', 'L14H0', 'L14H1', 'L14H2', 'L14H3', 'L14H4', 'L14H5', 'L14H6', 'L14H7', 'L14H8', 'L14H9', 'L14H10', 'L14H11', 'L14H12', 'L14H13', 'L14H14', 'L14H15', 'L14H16', 'L14H17', 'L14H18', 'L14H19', 'L14H20', 'L14H21', 'L14H22', 'L14H23', 'L14H24', 'L14H25', 'L14H26', 'L14H27', 'L14H28', 'L14H29', 'L14H30', 'L14H31', 'L15H0', 'L15H1', 'L15H2', 'L15H3', 'L15H4', 'L15H5', 'L15H6', 'L15H7', 'L15H8', 'L15H9', 'L15H10', 'L15H11', 'L15H12', 'L15H13', 'L15H14', 'L15H15', 'L15H16', 'L15H17', 'L15H18', 'L15H19', 'L15H20', 'L15H21', 'L15H22', 'L15H23', 'L15H24', 'L15H25', 'L15H26', 'L15H27', 'L15H28', 'L15H29', 'L15H30', 'L15H31', '0_mlp_out', '1_mlp_out', '2_mlp_out', '3_mlp_out', '4_mlp_out', '5_mlp_out', '6_mlp_out', '7_mlp_out', '8_mlp_out', '9_mlp_out', '10_mlp_out', '11_mlp_out', '12_mlp_out', '13_mlp_out', '14_mlp_out', '15_mlp_out', 'embed', 'bias']
Map:   0%|          | 1/1371 [00:00<04:52,  4.68 examples/s]Map:   0%|          | 3/1371 [00:00<02:42,  8.44 examples/s]Map:   0%|          | 5/1371 [00:00<02:14, 10.16 examples/s]Map:   1%|          | 7/1371 [00:00<01:47, 12.65 examples/s]Map:   1%|          | 9/1371 [00:00<01:54, 11.91 examples/s]Map:   1%|          | 11/1371 [00:00<01:47, 12.65 examples/s]Map:   1%|          | 13/1371 [00:01<01:41, 13.37 examples/s]Map:   1%|          | 15/1371 [00:01<01:35, 14.26 examples/s]Map:   1%|          | 17/1371 [00:01<01:34, 14.40 examples/s]Map:   1%|▏         | 19/1371 [00:01<01:28, 15.36 examples/s]Map:   2%|▏         | 21/1371 [00:01<01:26, 15.61 examples/s]Map:   2%|▏         | 23/1371 [00:01<01:22, 16.38 examples/s]Map:   2%|▏         | 25/1371 [00:01<01:32, 14.60 examples/s]Map:   2%|▏         | 27/1371 [00:02<01:58, 11.30 examples/s]Map:   2%|▏         | 29/1371 [00:02<01:51, 11.98 examples/s]Map:   2%|▏         | 31/1371 [00:02<01:53, 11.81 examples/s]Map:   2%|▏         | 33/1371 [00:02<01:48, 12.34 examples/s]Map:   3%|▎         | 35/1371 [00:02<01:44, 12.80 examples/s]Map:   3%|▎         | 37/1371 [00:02<01:52, 11.88 examples/s]Map:   3%|▎         | 39/1371 [00:03<01:49, 12.16 examples/s]Map:   3%|▎         | 41/1371 [00:03<01:57, 11.28 examples/s]Map:   3%|▎         | 43/1371 [00:03<01:49, 12.07 examples/s]Map:   3%|▎         | 45/1371 [00:03<01:43, 12.76 examples/s]Map:   3%|▎         | 47/1371 [00:03<01:41, 13.02 examples/s]Map:   4%|▎         | 49/1371 [00:03<01:33, 14.09 examples/s]Map:   4%|▎         | 51/1371 [00:03<01:29, 14.72 examples/s]Map:   4%|▍         | 53/1371 [00:04<01:31, 14.33 examples/s]Map:   4%|▍         | 55/1371 [00:04<01:29, 14.77 examples/s]Map:   4%|▍         | 57/1371 [00:04<01:46, 12.31 examples/s]Map:   4%|▍         | 59/1371 [00:04<01:40, 13.07 examples/s]Map:   4%|▍         | 61/1371 [00:04<01:42, 12.81 examples/s]Map:   5%|▍         | 63/1371 [00:04<01:35, 13.65 examples/s]Map:   5%|▍         | 65/1371 [00:04<01:28, 14.82 examples/s]Map:   5%|▍         | 67/1371 [00:05<01:32, 14.13 examples/s]Map:   5%|▌         | 69/1371 [00:05<01:38, 13.19 examples/s]Map:   5%|▌         | 71/1371 [00:05<01:41, 12.86 examples/s]Map:   5%|▌         | 73/1371 [00:05<01:32, 14.07 examples/s]Map:   5%|▌         | 75/1371 [00:05<01:30, 14.25 examples/s]Map:   6%|▌         | 77/1371 [00:05<01:29, 14.52 examples/s]Map:   6%|▌         | 79/1371 [00:06<01:28, 14.66 examples/s]Map:   6%|▌         | 81/1371 [00:06<02:00, 10.70 examples/s]Map:   6%|▌         | 83/1371 [00:06<01:55, 11.19 examples/s]Map:   6%|▌         | 85/1371 [00:06<01:46, 12.04 examples/s]Map:   6%|▋         | 87/1371 [00:06<01:45, 12.20 examples/s]Map:   6%|▋         | 89/1371 [00:06<01:47, 11.94 examples/s]Map:   7%|▋         | 91/1371 [00:07<01:54, 11.14 examples/s]Map:   7%|▋         | 93/1371 [00:07<01:44, 12.18 examples/s]Map:   7%|▋         | 95/1371 [00:07<01:48, 11.77 examples/s]Map:   7%|▋         | 97/1371 [00:07<01:41, 12.51 examples/s]Map:   7%|▋         | 99/1371 [00:07<01:38, 12.93 examples/s]Map:   7%|▋         | 101/1371 [00:07<01:37, 13.06 examples/s]Map:   8%|▊         | 103/1371 [00:08<01:32, 13.71 examples/s]Map:   8%|▊         | 105/1371 [00:08<01:33, 13.52 examples/s]Map:   8%|▊         | 107/1371 [00:08<01:29, 14.08 examples/s]Map:   8%|▊         | 109/1371 [00:08<01:23, 15.07 examples/s]Map:   8%|▊         | 111/1371 [00:08<01:28, 14.20 examples/s]Map:   8%|▊         | 113/1371 [00:08<01:22, 15.22 examples/s]Map:   8%|▊         | 115/1371 [00:08<01:19, 15.78 examples/s]Map:   9%|▊         | 117/1371 [00:08<01:16, 16.31 examples/s]Map:   9%|▊         | 119/1371 [00:09<01:21, 15.45 examples/s]Map:   9%|▉         | 121/1371 [00:09<01:19, 15.82 examples/s]Map:   9%|▉         | 123/1371 [00:09<01:23, 14.88 examples/s]Map:   9%|▉         | 125/1371 [00:09<01:22, 15.16 examples/s]Map:   9%|▉         | 127/1371 [00:09<01:46, 11.68 examples/s]Map:   9%|▉         | 129/1371 [00:09<01:57, 10.56 examples/s]Map:  10%|▉         | 131/1371 [00:10<01:46, 11.62 examples/s]Map:  10%|▉         | 133/1371 [00:10<01:38, 12.57 examples/s]Map:  10%|▉         | 135/1371 [00:10<01:39, 12.39 examples/s]Map:  10%|▉         | 137/1371 [00:10<01:48, 11.38 examples/s]Map:  10%|█         | 139/1371 [00:10<01:36, 12.71 examples/s]Map:  10%|█         | 141/1371 [00:10<01:33, 13.21 examples/s]Map:  10%|█         | 143/1371 [00:10<01:28, 13.80 examples/s]Map:  11%|█         | 145/1371 [00:11<01:23, 14.61 examples/s]Map:  11%|█         | 147/1371 [00:11<01:24, 14.48 examples/s]Map:  11%|█         | 149/1371 [00:11<01:27, 13.94 examples/s]Map:  11%|█         | 151/1371 [00:11<01:34, 12.92 examples/s]Map:  11%|█         | 153/1371 [00:11<01:41, 11.99 examples/s]Map:  11%|█▏        | 155/1371 [00:11<01:41, 11.97 examples/s]Map:  11%|█▏        | 157/1371 [00:12<01:55, 10.55 examples/s]Map:  12%|█▏        | 159/1371 [00:12<01:53, 10.65 examples/s]Map:  12%|█▏        | 161/1371 [00:12<01:47, 11.26 examples/s]Map:  12%|█▏        | 163/1371 [00:12<01:38, 12.32 examples/s]Map:  12%|█▏        | 165/1371 [00:12<02:02,  9.82 examples/s]Map:  12%|█▏        | 167/1371 [00:13<01:55, 10.46 examples/s]Map:  12%|█▏        | 169/1371 [00:13<01:48, 11.06 examples/s]Map:  12%|█▏        | 171/1371 [00:13<01:39, 12.05 examples/s]Map:  13%|█▎        | 173/1371 [00:13<01:39, 12.08 examples/s]Map:  13%|█▎        | 175/1371 [00:13<01:33, 12.72 examples/s]Map:  13%|█▎        | 177/1371 [00:13<01:32, 12.84 examples/s]Map:  13%|█▎        | 179/1371 [00:14<02:03,  9.65 examples/s]Map:  13%|█▎        | 181/1371 [00:14<01:48, 11.00 examples/s]Map:  13%|█▎        | 183/1371 [00:14<01:39, 11.93 examples/s]Map:  13%|█▎        | 185/1371 [00:14<01:37, 12.11 examples/s]Map:  14%|█▎        | 187/1371 [00:14<01:35, 12.41 examples/s]Map:  14%|█▍        | 189/1371 [00:14<01:36, 12.25 examples/s]Map:  14%|█▍        | 191/1371 [00:15<01:31, 12.92 examples/s]Map:  14%|█▍        | 193/1371 [00:15<01:32, 12.68 examples/s]Map:  14%|█▍        | 195/1371 [00:15<01:33, 12.55 examples/s]Map:  14%|█▍        | 197/1371 [00:15<02:04,  9.45 examples/s]Map:  15%|█▍        | 199/1371 [00:15<01:48, 10.76 examples/s]Map:  15%|█▍        | 201/1371 [00:15<01:44, 11.21 examples/s]Map:  15%|█▍        | 203/1371 [00:16<01:38, 11.83 examples/s]Map:  15%|█▍        | 205/1371 [00:16<01:30, 12.82 examples/s]Map:  15%|█▌        | 207/1371 [00:16<01:24, 13.77 examples/s]Map:  15%|█▌        | 209/1371 [00:16<01:26, 13.39 examples/s]Map:  15%|█▌        | 211/1371 [00:16<01:24, 13.73 examples/s]Map:  16%|█▌        | 213/1371 [00:16<01:30, 12.75 examples/s]Map:  16%|█▌        | 215/1371 [00:16<01:25, 13.53 examples/s]Map:  16%|█▌        | 217/1371 [00:17<01:25, 13.48 examples/s]Map:  16%|█▌        | 219/1371 [00:17<01:26, 13.27 examples/s]Map:  16%|█▌        | 221/1371 [00:17<01:24, 13.59 examples/s]Map:  16%|█▋        | 223/1371 [00:17<01:30, 12.68 examples/s]Map:  16%|█▋        | 225/1371 [00:17<01:44, 10.96 examples/s]Map:  17%|█▋        | 227/1371 [00:18<01:59,  9.61 examples/s]Map:  17%|█▋        | 229/1371 [00:18<01:45, 10.86 examples/s]Map:  17%|█▋        | 231/1371 [00:18<01:35, 11.99 examples/s]Map:  17%|█▋        | 233/1371 [00:18<01:32, 12.35 examples/s]Map:  17%|█▋        | 235/1371 [00:18<01:25, 13.22 examples/s]Map:  17%|█▋        | 237/1371 [00:18<01:31, 12.35 examples/s]Map:  17%|█▋        | 239/1371 [00:18<01:25, 13.22 examples/s]Map:  18%|█▊        | 241/1371 [00:19<01:39, 11.30 examples/s]Map:  18%|█▊        | 243/1371 [00:19<01:34, 11.92 examples/s]Map:  18%|█▊        | 245/1371 [00:19<01:35, 11.73 examples/s]Map:  18%|█▊        | 247/1371 [00:19<01:29, 12.63 examples/s]Map:  18%|█▊        | 249/1371 [00:19<01:27, 12.88 examples/s]Map:  18%|█▊        | 251/1371 [00:19<01:23, 13.36 examples/s]Map:  18%|█▊        | 253/1371 [00:20<01:23, 13.44 examples/s]Map:  19%|█▊        | 255/1371 [00:20<01:20, 13.79 examples/s]Map:  19%|█▊        | 257/1371 [00:20<01:20, 13.78 examples/s]Map:  19%|█▉        | 259/1371 [00:20<01:20, 13.87 examples/s]Map:  19%|█▉        | 261/1371 [00:20<01:24, 13.09 examples/s]Map:  19%|█▉        | 263/1371 [00:20<01:18, 14.04 examples/s]Map:  19%|█▉        | 265/1371 [00:20<01:17, 14.33 examples/s]Map:  19%|█▉        | 267/1371 [00:21<01:18, 14.11 examples/s]Map:  20%|█▉        | 269/1371 [00:21<01:15, 14.65 examples/s]Map:  20%|█▉        | 271/1371 [00:21<01:13, 14.97 examples/s]Map:  20%|█▉        | 273/1371 [00:21<01:19, 13.80 examples/s]Map:  20%|██        | 275/1371 [00:21<01:16, 14.37 examples/s]Map:  20%|██        | 277/1371 [00:21<01:14, 14.71 examples/s]Map:  20%|██        | 279/1371 [00:21<01:12, 15.00 examples/s]Map:  20%|██        | 281/1371 [00:22<01:11, 15.18 examples/s]Map:  21%|██        | 283/1371 [00:22<01:46, 10.22 examples/s]Map:  21%|██        | 285/1371 [00:22<01:34, 11.53 examples/s]Map:  21%|██        | 287/1371 [00:22<01:25, 12.69 examples/s]Map:  21%|██        | 289/1371 [00:22<01:19, 13.67 examples/s]Map:  21%|██        | 291/1371 [00:22<01:32, 11.62 examples/s]Map:  21%|██▏       | 293/1371 [00:23<01:25, 12.66 examples/s]Map:  22%|██▏       | 295/1371 [00:23<01:20, 13.40 examples/s]Map:  22%|██▏       | 297/1371 [00:23<01:17, 13.82 examples/s]Map:  22%|██▏       | 299/1371 [00:23<01:14, 14.48 examples/s]Map:  22%|██▏       | 301/1371 [00:23<01:22, 12.99 examples/s]Map:  22%|██▏       | 303/1371 [00:23<01:18, 13.66 examples/s]Map:  22%|██▏       | 305/1371 [00:23<01:26, 12.34 examples/s]Map:  22%|██▏       | 307/1371 [00:24<01:24, 12.62 examples/s]Map:  23%|██▎       | 309/1371 [00:24<01:23, 12.68 examples/s]Map:  23%|██▎       | 311/1371 [00:24<01:23, 12.65 examples/s]Map:  23%|██▎       | 313/1371 [00:24<01:20, 13.08 examples/s]Map:  23%|██▎       | 315/1371 [00:24<01:18, 13.44 examples/s]Map:  23%|██▎       | 317/1371 [00:24<01:19, 13.23 examples/s]Map:  23%|██▎       | 319/1371 [00:25<01:16, 13.81 examples/s]Map:  23%|██▎       | 321/1371 [00:25<01:17, 13.63 examples/s]Map:  24%|██▎       | 323/1371 [00:25<01:21, 12.83 examples/s]Map:  24%|██▎       | 325/1371 [00:25<01:30, 11.58 examples/s]Map:  24%|██▍       | 327/1371 [00:25<01:34, 11.04 examples/s]Map:  24%|██▍       | 329/1371 [00:26<02:07,  8.18 examples/s]Map:  24%|██▍       | 331/1371 [00:26<01:49,  9.50 examples/s]Map:  24%|██▍       | 333/1371 [00:26<01:40, 10.36 examples/s]Map:  24%|██▍       | 335/1371 [00:26<01:32, 11.18 examples/s]Map:  25%|██▍       | 337/1371 [00:26<01:27, 11.84 examples/s]Map:  25%|██▍       | 339/1371 [00:26<01:42, 10.03 examples/s]Map:  25%|██▍       | 341/1371 [00:27<01:33, 11.07 examples/s]Map:  25%|██▌       | 343/1371 [00:27<01:26, 11.83 examples/s]Map:  25%|██▌       | 345/1371 [00:27<01:35, 10.78 examples/s]Map:  25%|██▌       | 347/1371 [00:27<01:28, 11.51 examples/s]Map:  25%|██▌       | 349/1371 [00:27<01:30, 11.31 examples/s]Map:  26%|██▌       | 351/1371 [00:28<01:38, 10.32 examples/s]Map:  26%|██▌       | 353/1371 [00:28<01:47,  9.47 examples/s]Map:  26%|██▌       | 355/1371 [00:28<01:34, 10.72 examples/s]Map:  26%|██▌       | 357/1371 [00:28<01:28, 11.40 examples/s]Map:  26%|██▌       | 359/1371 [00:28<01:24, 11.94 examples/s]Map:  26%|██▋       | 361/1371 [00:28<01:28, 11.35 examples/s]Map:  26%|██▋       | 363/1371 [00:29<01:28, 11.42 examples/s]Map:  27%|██▋       | 365/1371 [00:29<01:26, 11.59 examples/s]Map:  27%|██▋       | 367/1371 [00:29<01:47,  9.36 examples/s]Map:  27%|██▋       | 369/1371 [00:29<01:39, 10.09 examples/s]Map:  27%|██▋       | 371/1371 [00:29<01:37, 10.25 examples/s]Map:  27%|██▋       | 373/1371 [00:30<01:34, 10.61 examples/s]Map:  27%|██▋       | 375/1371 [00:30<01:27, 11.41 examples/s]Map:  27%|██▋       | 377/1371 [00:30<01:21, 12.23 examples/s]Map:  28%|██▊       | 379/1371 [00:30<01:20, 12.35 examples/s]Map:  28%|██▊       | 381/1371 [00:30<01:28, 11.22 examples/s]Map:  28%|██▊       | 383/1371 [00:31<01:46,  9.31 examples/s]Map:  28%|██▊       | 385/1371 [00:31<01:35, 10.36 examples/s]Map:  28%|██▊       | 387/1371 [00:31<01:31, 10.75 examples/s]Map:  28%|██▊       | 389/1371 [00:31<01:28, 11.14 examples/s]Map:  29%|██▊       | 391/1371 [00:31<01:21, 12.08 examples/s]Map:  29%|██▊       | 393/1371 [00:31<01:18, 12.39 examples/s]Map:  29%|██▉       | 395/1371 [00:31<01:17, 12.52 examples/s]Map:  29%|██▉       | 397/1371 [00:32<01:19, 12.19 examples/s]Map:  29%|██▉       | 399/1371 [00:32<01:19, 12.22 examples/s]Map:  29%|██▉       | 401/1371 [00:32<01:14, 13.08 examples/s]Map:  29%|██▉       | 403/1371 [00:32<01:14, 12.92 examples/s]Map:  30%|██▉       | 405/1371 [00:32<01:11, 13.49 examples/s]Map:  30%|██▉       | 407/1371 [00:32<01:08, 14.16 examples/s]Map:  30%|██▉       | 409/1371 [00:33<01:22, 11.67 examples/s]Map:  30%|██▉       | 411/1371 [00:33<01:15, 12.76 examples/s]Map:  30%|███       | 413/1371 [00:33<01:11, 13.42 examples/s]Map:  30%|███       | 415/1371 [00:33<01:10, 13.59 examples/s]Map:  30%|███       | 417/1371 [00:33<01:06, 14.35 examples/s]Map:  31%|███       | 419/1371 [00:33<01:05, 14.56 examples/s]Map:  31%|███       | 421/1371 [00:34<01:26, 11.00 examples/s]Map:  31%|███       | 423/1371 [00:34<01:22, 11.55 examples/s]Map:  31%|███       | 425/1371 [00:34<01:19, 11.88 examples/s]Map:  31%|███       | 427/1371 [00:34<01:26, 10.90 examples/s]Map:  31%|███▏      | 429/1371 [00:34<01:18, 12.05 examples/s]Map:  31%|███▏      | 431/1371 [00:34<01:18, 11.91 examples/s]Map:  32%|███▏      | 433/1371 [00:34<01:14, 12.58 examples/s]Map:  32%|███▏      | 435/1371 [00:35<01:10, 13.31 examples/s]Map:  32%|███▏      | 437/1371 [00:35<01:10, 13.29 examples/s]Map:  32%|███▏      | 439/1371 [00:35<01:06, 14.04 examples/s]Map:  32%|███▏      | 441/1371 [00:35<01:04, 14.35 examples/s]Map:  32%|███▏      | 443/1371 [00:35<01:05, 14.26 examples/s]Map:  32%|███▏      | 445/1371 [00:35<01:11, 13.02 examples/s]Map:  33%|███▎      | 447/1371 [00:35<01:07, 13.77 examples/s]Map:  33%|███▎      | 449/1371 [00:36<01:07, 13.63 examples/s]Map:  33%|███▎      | 451/1371 [00:36<01:14, 12.42 examples/s]Map:  33%|███▎      | 453/1371 [00:36<01:28, 10.32 examples/s]Map:  33%|███▎      | 455/1371 [00:36<01:24, 10.88 examples/s]Map:  33%|███▎      | 457/1371 [00:36<01:20, 11.30 examples/s]Map:  33%|███▎      | 459/1371 [00:37<01:18, 11.68 examples/s]Map:  34%|███▎      | 461/1371 [00:37<01:12, 12.56 examples/s]Map:  34%|███▍      | 463/1371 [00:37<01:08, 13.35 examples/s]Map:  34%|███▍      | 465/1371 [00:37<01:06, 13.68 examples/s]Map:  34%|███▍      | 467/1371 [00:37<01:06, 13.59 examples/s]Map:  34%|███▍      | 469/1371 [00:37<01:09, 12.94 examples/s]Map:  34%|███▍      | 471/1371 [00:38<01:46,  8.47 examples/s]Map:  35%|███▍      | 473/1371 [00:38<01:33,  9.65 examples/s]Map:  35%|███▍      | 475/1371 [00:38<01:30,  9.86 examples/s]Map:  35%|███▍      | 477/1371 [00:38<01:26, 10.34 examples/s]Map:  35%|███▍      | 479/1371 [00:38<01:22, 10.80 examples/s]Map:  35%|███▌      | 481/1371 [00:39<01:17, 11.44 examples/s]Map:  35%|███▌      | 483/1371 [00:39<01:12, 12.20 examples/s]Map:  35%|███▌      | 485/1371 [00:39<01:27, 10.14 examples/s]Map:  36%|███▌      | 487/1371 [00:39<01:18, 11.32 examples/s]Map:  36%|███▌      | 489/1371 [00:39<01:15, 11.75 examples/s]Map:  36%|███▌      | 491/1371 [00:39<01:10, 12.48 examples/s]Map:  36%|███▌      | 493/1371 [00:40<01:06, 13.25 examples/s]Map:  36%|███▌      | 495/1371 [00:40<01:07, 13.05 examples/s]Map:  36%|███▋      | 497/1371 [00:40<01:07, 12.88 examples/s]Map:  36%|███▋      | 499/1371 [00:40<01:07, 12.91 examples/s]Map:  37%|███▋      | 501/1371 [00:40<01:11, 12.16 examples/s]Map:  37%|███▋      | 503/1371 [00:40<01:14, 11.63 examples/s]Map:  37%|███▋      | 505/1371 [00:40<01:10, 12.29 examples/s]Map:  37%|███▋      | 507/1371 [00:41<01:06, 12.95 examples/s]Map:  37%|███▋      | 509/1371 [00:41<01:07, 12.71 examples/s]Map:  37%|███▋      | 511/1371 [00:41<01:07, 12.69 examples/s]Map:  37%|███▋      | 513/1371 [00:41<01:05, 13.08 examples/s]Map:  38%|███▊      | 515/1371 [00:41<01:07, 12.61 examples/s]Map:  38%|███▊      | 517/1371 [00:41<01:04, 13.19 examples/s]Map:  38%|███▊      | 519/1371 [00:42<01:11, 11.99 examples/s]Map:  38%|███▊      | 521/1371 [00:42<01:07, 12.50 examples/s]Map:  38%|███▊      | 523/1371 [00:42<01:05, 12.86 examples/s]Map:  38%|███▊      | 525/1371 [00:42<01:03, 13.25 examples/s]Map:  38%|███▊      | 527/1371 [00:42<01:09, 12.11 examples/s]Map:  39%|███▊      | 529/1371 [00:42<01:06, 12.69 examples/s]Map:  39%|███▊      | 531/1371 [00:43<01:07, 12.38 examples/s]Map:  39%|███▉      | 533/1371 [00:43<01:06, 12.58 examples/s]Map:  39%|███▉      | 535/1371 [00:43<01:08, 12.17 examples/s]Map:  39%|███▉      | 537/1371 [00:43<01:13, 11.37 examples/s]Map:  39%|███▉      | 539/1371 [00:43<01:10, 11.75 examples/s]Map:  39%|███▉      | 541/1371 [00:44<01:26,  9.64 examples/s]Map:  40%|███▉      | 543/1371 [00:44<01:18, 10.58 examples/s]Map:  40%|███▉      | 545/1371 [00:44<01:14, 11.05 examples/s]Map:  40%|███▉      | 547/1371 [00:44<01:13, 11.28 examples/s]Map:  40%|████      | 549/1371 [00:44<01:07, 12.13 examples/s]Map:  40%|████      | 551/1371 [00:44<01:04, 12.64 examples/s]Map:  40%|████      | 553/1371 [00:44<01:04, 12.75 examples/s]Map:  40%|████      | 555/1371 [00:45<01:02, 13.08 examples/s]Map:  41%|████      | 557/1371 [00:45<01:01, 13.20 examples/s]Map:  41%|████      | 559/1371 [00:45<01:01, 13.11 examples/s]Map:  41%|████      | 561/1371 [00:45<01:00, 13.37 examples/s]Map:  41%|████      | 563/1371 [00:45<00:58, 13.74 examples/s]Map:  41%|████      | 565/1371 [00:45<01:07, 11.91 examples/s]Map:  41%|████▏     | 567/1371 [00:46<01:06, 12.16 examples/s]Map:  42%|████▏     | 569/1371 [00:46<01:02, 12.77 examples/s]Map:  42%|████▏     | 571/1371 [00:46<01:01, 12.92 examples/s]Map:  42%|████▏     | 573/1371 [00:46<01:04, 12.33 examples/s]Map:  42%|████▏     | 575/1371 [00:46<01:07, 11.86 examples/s]Map:  42%|████▏     | 577/1371 [00:46<01:12, 10.95 examples/s]Map:  42%|████▏     | 579/1371 [00:47<01:07, 11.80 examples/s]Map:  42%|████▏     | 581/1371 [00:47<01:02, 12.68 examples/s]Map:  43%|████▎     | 583/1371 [00:47<01:01, 12.82 examples/s]Map:  43%|████▎     | 585/1371 [00:47<01:00, 12.94 examples/s]Map:  43%|████▎     | 587/1371 [00:47<01:00, 12.98 examples/s]Map:  43%|████▎     | 589/1371 [00:47<01:02, 12.47 examples/s]Map:  43%|████▎     | 591/1371 [00:47<01:02, 12.40 examples/s]Map:  43%|████▎     | 593/1371 [00:48<01:00, 12.83 examples/s]Map:  43%|████▎     | 595/1371 [00:48<01:14, 10.47 examples/s]Map:  44%|████▎     | 597/1371 [00:48<01:07, 11.39 examples/s]Map:  44%|████▎     | 599/1371 [00:48<01:13, 10.53 examples/s]Map:  44%|████▍     | 601/1371 [00:48<01:08, 11.29 examples/s]Map:  44%|████▍     | 603/1371 [00:49<01:08, 11.29 examples/s]Map:  44%|████▍     | 605/1371 [00:49<01:04, 11.83 examples/s]Map:  44%|████▍     | 607/1371 [00:49<01:04, 11.89 examples/s]Map:  44%|████▍     | 609/1371 [00:49<01:00, 12.52 examples/s]Map:  45%|████▍     | 611/1371 [00:49<01:01, 12.42 examples/s]Map:  45%|████▍     | 613/1371 [00:49<01:05, 11.54 examples/s]Map:  45%|████▍     | 615/1371 [00:50<01:06, 11.30 examples/s]Map:  45%|████▌     | 617/1371 [00:50<01:02, 12.05 examples/s]Map:  45%|████▌     | 619/1371 [00:50<01:02, 11.96 examples/s]Map:  45%|████▌     | 621/1371 [00:50<01:02, 12.09 examples/s]Map:  45%|████▌     | 623/1371 [00:50<01:01, 12.19 examples/s]Map:  46%|████▌     | 625/1371 [00:50<01:04, 11.63 examples/s]Map:  46%|████▌     | 627/1371 [00:51<01:00, 12.33 examples/s]Map:  46%|████▌     | 629/1371 [00:51<00:58, 12.61 examples/s]Map:  46%|████▌     | 631/1371 [00:51<01:00, 12.15 examples/s]Map:  46%|████▌     | 633/1371 [00:51<01:02, 11.80 examples/s]Map:  46%|████▋     | 635/1371 [00:51<01:00, 12.11 examples/s]Map:  46%|████▋     | 637/1371 [00:51<00:58, 12.55 examples/s]Map:  47%|████▋     | 639/1371 [00:52<01:00, 12.10 examples/s]Map:  47%|████▋     | 641/1371 [00:52<01:12, 10.07 examples/s]Map:  47%|████▋     | 643/1371 [00:52<01:10, 10.29 examples/s]Map:  47%|████▋     | 645/1371 [00:52<01:12, 10.04 examples/s]Map:  47%|████▋     | 647/1371 [00:52<01:06, 10.97 examples/s]Map:  47%|████▋     | 649/1371 [00:53<01:02, 11.55 examples/s]Map:  47%|████▋     | 651/1371 [00:53<00:59, 12.20 examples/s]Map:  48%|████▊     | 653/1371 [00:53<00:57, 12.47 examples/s]Map:  48%|████▊     | 655/1371 [00:53<01:01, 11.69 examples/s]Map:  48%|████▊     | 657/1371 [00:53<01:02, 11.34 examples/s]Map:  48%|████▊     | 659/1371 [00:53<01:00, 11.68 examples/s]Map:  48%|████▊     | 661/1371 [00:54<01:00, 11.80 examples/s]Map:  48%|████▊     | 663/1371 [00:54<00:59, 11.99 examples/s]Map:  49%|████▊     | 665/1371 [00:54<01:03, 11.13 examples/s]Map:  49%|████▊     | 667/1371 [00:54<01:04, 10.94 examples/s]Map:  49%|████▉     | 669/1371 [00:54<01:00, 11.59 examples/s]Map:  49%|████▉     | 671/1371 [00:54<00:59, 11.67 examples/s]Map:  49%|████▉     | 673/1371 [00:55<01:11,  9.74 examples/s]Map:  49%|████▉     | 675/1371 [00:55<01:07, 10.27 examples/s]Map:  49%|████▉     | 677/1371 [00:55<01:06, 10.51 examples/s]Map:  50%|████▉     | 679/1371 [00:55<01:23,  8.34 examples/s]Map:  50%|████▉     | 681/1371 [00:56<01:15,  9.12 examples/s]Map:  50%|████▉     | 683/1371 [00:56<01:12,  9.52 examples/s]Map:  50%|████▉     | 685/1371 [00:56<01:07, 10.15 examples/s]Map:  50%|█████     | 687/1371 [00:56<01:04, 10.55 examples/s]Map:  50%|█████     | 689/1371 [00:56<01:03, 10.82 examples/s]Map:  50%|█████     | 691/1371 [00:56<01:05, 10.38 examples/s]Map:  51%|█████     | 693/1371 [00:57<01:00, 11.16 examples/s]Map:  51%|█████     | 695/1371 [00:57<00:58, 11.51 examples/s]Map:  51%|█████     | 697/1371 [00:57<00:55, 12.13 examples/s]Map:  51%|█████     | 699/1371 [00:57<00:58, 11.53 examples/s]Map:  51%|█████     | 701/1371 [00:57<01:03, 10.62 examples/s]Map:  51%|█████▏    | 703/1371 [00:57<01:00, 11.08 examples/s]Map:  51%|█████▏    | 705/1371 [00:58<01:00, 10.92 examples/s]Map:  52%|█████▏    | 707/1371 [00:58<00:56, 11.71 examples/s]Map:  52%|█████▏    | 709/1371 [00:58<00:58, 11.39 examples/s]Map:  52%|█████▏    | 711/1371 [00:58<01:08,  9.65 examples/s]Map:  52%|█████▏    | 713/1371 [00:58<01:02, 10.48 examples/s]Map:  52%|█████▏    | 715/1371 [00:59<01:00, 10.88 examples/s]Map:  52%|█████▏    | 717/1371 [00:59<00:55, 11.71 examples/s]Map:  52%|█████▏    | 719/1371 [00:59<00:54, 11.94 examples/s]Map:  53%|█████▎    | 721/1371 [00:59<00:56, 11.55 examples/s]Map:  53%|█████▎    | 723/1371 [00:59<00:54, 11.90 examples/s]Map:  53%|█████▎    | 725/1371 [00:59<00:57, 11.17 examples/s]Map:  53%|█████▎    | 727/1371 [01:00<00:54, 11.80 examples/s]Map:  53%|█████▎    | 729/1371 [01:00<00:55, 11.48 examples/s]Map:  53%|█████▎    | 731/1371 [01:00<00:52, 12.15 examples/s]Map:  53%|█████▎    | 733/1371 [01:00<00:53, 11.99 examples/s]Map:  54%|█████▎    | 735/1371 [01:00<00:55, 11.44 examples/s]Map:  54%|█████▍    | 737/1371 [01:01<01:11,  8.82 examples/s]Map:  54%|█████▍    | 739/1371 [01:01<01:03,  9.89 examples/s]Map:  54%|█████▍    | 741/1371 [01:01<01:14,  8.44 examples/s]Map:  54%|█████▍    | 743/1371 [01:01<01:06,  9.48 examples/s]Map:  54%|█████▍    | 745/1371 [01:01<01:01, 10.16 examples/s]Map:  54%|█████▍    | 747/1371 [01:02<00:56, 11.08 examples/s]Map:  55%|█████▍    | 749/1371 [01:02<00:53, 11.62 examples/s]Map:  55%|█████▍    | 751/1371 [01:02<00:53, 11.55 examples/s]Map:  55%|█████▍    | 753/1371 [01:02<00:53, 11.46 examples/s]Map:  55%|█████▌    | 755/1371 [01:02<00:54, 11.27 examples/s]Map:  55%|█████▌    | 757/1371 [01:02<00:58, 10.43 examples/s]Map:  55%|█████▌    | 759/1371 [01:03<00:58, 10.48 examples/s]Map:  56%|█████▌    | 761/1371 [01:03<00:59, 10.32 examples/s]Map:  56%|█████▌    | 763/1371 [01:03<00:58, 10.40 examples/s]Map:  56%|█████▌    | 765/1371 [01:03<01:00, 10.00 examples/s]Map:  56%|█████▌    | 767/1371 [01:03<00:59, 10.21 examples/s]Map:  56%|█████▌    | 769/1371 [01:04<00:55, 10.90 examples/s]Map:  56%|█████▌    | 771/1371 [01:04<00:56, 10.66 examples/s]Map:  56%|█████▋    | 773/1371 [01:04<00:53, 11.14 examples/s]Map:  57%|█████▋    | 775/1371 [01:04<00:53, 11.12 examples/s]Map:  57%|█████▋    | 777/1371 [01:04<00:51, 11.48 examples/s]Map:  57%|█████▋    | 779/1371 [01:04<00:49, 11.86 examples/s]Map:  57%|█████▋    | 781/1371 [01:05<00:56, 10.39 examples/s]Map:  57%|█████▋    | 783/1371 [01:05<00:57, 10.23 examples/s]Map:  57%|█████▋    | 785/1371 [01:05<01:01,  9.45 examples/s]Map:  57%|█████▋    | 787/1371 [01:05<00:57, 10.17 examples/s]Map:  58%|█████▊    | 789/1371 [01:06<00:59,  9.81 examples/s]Map:  58%|█████▊    | 791/1371 [01:06<00:57, 10.11 examples/s]Map:  58%|█████▊    | 793/1371 [01:06<00:58,  9.87 examples/s]Map:  58%|█████▊    | 795/1371 [01:06<00:53, 10.80 examples/s]Map:  58%|█████▊    | 797/1371 [01:06<01:02,  9.25 examples/s]Map:  58%|█████▊    | 799/1371 [01:07<00:55, 10.22 examples/s]Map:  58%|█████▊    | 801/1371 [01:07<00:56, 10.16 examples/s]Map:  59%|█████▊    | 803/1371 [01:07<00:55, 10.24 examples/s]Map:  59%|█████▊    | 805/1371 [01:07<00:53, 10.65 examples/s]Map:  59%|█████▉    | 807/1371 [01:07<00:52, 10.67 examples/s]Map:  59%|█████▉    | 809/1371 [01:07<00:48, 11.49 examples/s]Map:  59%|█████▉    | 811/1371 [01:08<00:54, 10.35 examples/s]Map:  59%|█████▉    | 813/1371 [01:08<00:49, 11.24 examples/s]Map:  59%|█████▉    | 815/1371 [01:08<00:48, 11.48 examples/s]Map:  60%|█████▉    | 817/1371 [01:08<00:48, 11.46 examples/s]Map:  60%|█████▉    | 819/1371 [01:08<00:46, 11.81 examples/s]Map:  60%|█████▉    | 821/1371 [01:08<00:46, 11.93 examples/s]Map:  60%|█████▉    | 822/1371 [01:09<00:46, 11.85 examples/s]
Traceback (most recent call last):
  File "/home/g/grimmj/IdiomHeads/compute_logit_attr.py", line 47, in <module>
    data.map(lambda batch: scorer.compute_logit_attr_batched(batch, grouped_file), batched=True, batch_size = batch_size)
  File "/home/g/grimmj/miniconda3/envs/idiom/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 562, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
                                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/g/grimmj/miniconda3/envs/idiom/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 3079, in map
    for rank, done, content in Dataset._map_single(**dataset_kwargs):
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/g/grimmj/miniconda3/envs/idiom/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 3519, in _map_single
    for i, batch in iter_outputs(shard_iterable):
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/g/grimmj/miniconda3/envs/idiom/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 3469, in iter_outputs
    yield i, apply_function(example, i, offset=offset)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/g/grimmj/miniconda3/envs/idiom/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 3392, in apply_function
    processed_inputs = function(*fn_args, *additional_args, **fn_kwargs)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/g/grimmj/IdiomHeads/compute_logit_attr.py", line 47, in <lambda>
    data.map(lambda batch: scorer.compute_logit_attr_batched(batch, grouped_file), batched=True, batch_size = batch_size)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/g/grimmj/IdiomHeads/logit_attribution.py", line 110, in compute_logit_attr_batched
    sent_score = self.compute_logit_attr(batch["sentence"][i])
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/g/grimmj/IdiomHeads/logit_attribution.py", line 94, in compute_logit_attr
    logit_attr = self.logit_attrs(tokens, has_batch_dim=False)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/g/grimmj/IdiomHeads/logit_attribution.py", line 234, in logit_attrs
    logit_attrs = (scaled_residual_stack * logit_directions).sum(dim=-1)
                   ~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 946.00 MiB. GPU 0 has a total capacity of 7.60 GiB of which 865.88 MiB is free. Including non-PyTorch memory, this process has 6.74 GiB memory in use. Of the allocated memory 5.70 GiB is allocated by PyTorch, and 954.79 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
