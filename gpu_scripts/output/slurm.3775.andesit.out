slurmstepd-andesit: error: Unable to create TMPDIR [/tmp/user/32202]: Permission denied
slurmstepd-andesit: error: Setting TMPDIR to /tmp
WARNING:root:float16 models may not work on CPU. Consider using a GPU or bfloat16.
WARNING:root:With reduced precision, it is advised to use `from_pretrained_no_processing` instead of `from_pretrained`.
WARNING:root:You are not using LayerNorm, so the writing weights can't be centered! Skipping
Loaded pretrained model meta-llama/Llama-3.2-1B-Instruct into HookedTransformer

Model uses LayerNorm!

Running logit attribution on device cuda.

Processing split:  formal
Map:   0%|          | 0/1373 [00:00<?, ? examples/s]
Computing logit attribution for the following components:
['L0H0', 'L0H1', 'L0H2', 'L0H3', 'L0H4', 'L0H5', 'L0H6', 'L0H7', 'L0H8', 'L0H9', 'L0H10', 'L0H11', 'L0H12', 'L0H13', 'L0H14', 'L0H15', 'L0H16', 'L0H17', 'L0H18', 'L0H19', 'L0H20', 'L0H21', 'L0H22', 'L0H23', 'L0H24', 'L0H25', 'L0H26', 'L0H27', 'L0H28', 'L0H29', 'L0H30', 'L0H31', 'L1H0', 'L1H1', 'L1H2', 'L1H3', 'L1H4', 'L1H5', 'L1H6', 'L1H7', 'L1H8', 'L1H9', 'L1H10', 'L1H11', 'L1H12', 'L1H13', 'L1H14', 'L1H15', 'L1H16', 'L1H17', 'L1H18', 'L1H19', 'L1H20', 'L1H21', 'L1H22', 'L1H23', 'L1H24', 'L1H25', 'L1H26', 'L1H27', 'L1H28', 'L1H29', 'L1H30', 'L1H31', 'L2H0', 'L2H1', 'L2H2', 'L2H3', 'L2H4', 'L2H5', 'L2H6', 'L2H7', 'L2H8', 'L2H9', 'L2H10', 'L2H11', 'L2H12', 'L2H13', 'L2H14', 'L2H15', 'L2H16', 'L2H17', 'L2H18', 'L2H19', 'L2H20', 'L2H21', 'L2H22', 'L2H23', 'L2H24', 'L2H25', 'L2H26', 'L2H27', 'L2H28', 'L2H29', 'L2H30', 'L2H31', 'L3H0', 'L3H1', 'L3H2', 'L3H3', 'L3H4', 'L3H5', 'L3H6', 'L3H7', 'L3H8', 'L3H9', 'L3H10', 'L3H11', 'L3H12', 'L3H13', 'L3H14', 'L3H15', 'L3H16', 'L3H17', 'L3H18', 'L3H19', 'L3H20', 'L3H21', 'L3H22', 'L3H23', 'L3H24', 'L3H25', 'L3H26', 'L3H27', 'L3H28', 'L3H29', 'L3H30', 'L3H31', 'L4H0', 'L4H1', 'L4H2', 'L4H3', 'L4H4', 'L4H5', 'L4H6', 'L4H7', 'L4H8', 'L4H9', 'L4H10', 'L4H11', 'L4H12', 'L4H13', 'L4H14', 'L4H15', 'L4H16', 'L4H17', 'L4H18', 'L4H19', 'L4H20', 'L4H21', 'L4H22', 'L4H23', 'L4H24', 'L4H25', 'L4H26', 'L4H27', 'L4H28', 'L4H29', 'L4H30', 'L4H31', 'L5H0', 'L5H1', 'L5H2', 'L5H3', 'L5H4', 'L5H5', 'L5H6', 'L5H7', 'L5H8', 'L5H9', 'L5H10', 'L5H11', 'L5H12', 'L5H13', 'L5H14', 'L5H15', 'L5H16', 'L5H17', 'L5H18', 'L5H19', 'L5H20', 'L5H21', 'L5H22', 'L5H23', 'L5H24', 'L5H25', 'L5H26', 'L5H27', 'L5H28', 'L5H29', 'L5H30', 'L5H31', 'L6H0', 'L6H1', 'L6H2', 'L6H3', 'L6H4', 'L6H5', 'L6H6', 'L6H7', 'L6H8', 'L6H9', 'L6H10', 'L6H11', 'L6H12', 'L6H13', 'L6H14', 'L6H15', 'L6H16', 'L6H17', 'L6H18', 'L6H19', 'L6H20', 'L6H21', 'L6H22', 'L6H23', 'L6H24', 'L6H25', 'L6H26', 'L6H27', 'L6H28', 'L6H29', 'L6H30', 'L6H31', 'L7H0', 'L7H1', 'L7H2', 'L7H3', 'L7H4', 'L7H5', 'L7H6', 'L7H7', 'L7H8', 'L7H9', 'L7H10', 'L7H11', 'L7H12', 'L7H13', 'L7H14', 'L7H15', 'L7H16', 'L7H17', 'L7H18', 'L7H19', 'L7H20', 'L7H21', 'L7H22', 'L7H23', 'L7H24', 'L7H25', 'L7H26', 'L7H27', 'L7H28', 'L7H29', 'L7H30', 'L7H31', 'L8H0', 'L8H1', 'L8H2', 'L8H3', 'L8H4', 'L8H5', 'L8H6', 'L8H7', 'L8H8', 'L8H9', 'L8H10', 'L8H11', 'L8H12', 'L8H13', 'L8H14', 'L8H15', 'L8H16', 'L8H17', 'L8H18', 'L8H19', 'L8H20', 'L8H21', 'L8H22', 'L8H23', 'L8H24', 'L8H25', 'L8H26', 'L8H27', 'L8H28', 'L8H29', 'L8H30', 'L8H31', 'L9H0', 'L9H1', 'L9H2', 'L9H3', 'L9H4', 'L9H5', 'L9H6', 'L9H7', 'L9H8', 'L9H9', 'L9H10', 'L9H11', 'L9H12', 'L9H13', 'L9H14', 'L9H15', 'L9H16', 'L9H17', 'L9H18', 'L9H19', 'L9H20', 'L9H21', 'L9H22', 'L9H23', 'L9H24', 'L9H25', 'L9H26', 'L9H27', 'L9H28', 'L9H29', 'L9H30', 'L9H31', 'L10H0', 'L10H1', 'L10H2', 'L10H3', 'L10H4', 'L10H5', 'L10H6', 'L10H7', 'L10H8', 'L10H9', 'L10H10', 'L10H11', 'L10H12', 'L10H13', 'L10H14', 'L10H15', 'L10H16', 'L10H17', 'L10H18', 'L10H19', 'L10H20', 'L10H21', 'L10H22', 'L10H23', 'L10H24', 'L10H25', 'L10H26', 'L10H27', 'L10H28', 'L10H29', 'L10H30', 'L10H31', 'L11H0', 'L11H1', 'L11H2', 'L11H3', 'L11H4', 'L11H5', 'L11H6', 'L11H7', 'L11H8', 'L11H9', 'L11H10', 'L11H11', 'L11H12', 'L11H13', 'L11H14', 'L11H15', 'L11H16', 'L11H17', 'L11H18', 'L11H19', 'L11H20', 'L11H21', 'L11H22', 'L11H23', 'L11H24', 'L11H25', 'L11H26', 'L11H27', 'L11H28', 'L11H29', 'L11H30', 'L11H31', 'L12H0', 'L12H1', 'L12H2', 'L12H3', 'L12H4', 'L12H5', 'L12H6', 'L12H7', 'L12H8', 'L12H9', 'L12H10', 'L12H11', 'L12H12', 'L12H13', 'L12H14', 'L12H15', 'L12H16', 'L12H17', 'L12H18', 'L12H19', 'L12H20', 'L12H21', 'L12H22', 'L12H23', 'L12H24', 'L12H25', 'L12H26', 'L12H27', 'L12H28', 'L12H29', 'L12H30', 'L12H31', 'L13H0', 'L13H1', 'L13H2', 'L13H3', 'L13H4', 'L13H5', 'L13H6', 'L13H7', 'L13H8', 'L13H9', 'L13H10', 'L13H11', 'L13H12', 'L13H13', 'L13H14', 'L13H15', 'L13H16', 'L13H17', 'L13H18', 'L13H19', 'L13H20', 'L13H21', 'L13H22', 'L13H23', 'L13H24', 'L13H25', 'L13H26', 'L13H27', 'L13H28', 'L13H29', 'L13H30', 'L13H31', 'L14H0', 'L14H1', 'L14H2', 'L14H3', 'L14H4', 'L14H5', 'L14H6', 'L14H7', 'L14H8', 'L14H9', 'L14H10', 'L14H11', 'L14H12', 'L14H13', 'L14H14', 'L14H15', 'L14H16', 'L14H17', 'L14H18', 'L14H19', 'L14H20', 'L14H21', 'L14H22', 'L14H23', 'L14H24', 'L14H25', 'L14H26', 'L14H27', 'L14H28', 'L14H29', 'L14H30', 'L14H31', 'L15H0', 'L15H1', 'L15H2', 'L15H3', 'L15H4', 'L15H5', 'L15H6', 'L15H7', 'L15H8', 'L15H9', 'L15H10', 'L15H11', 'L15H12', 'L15H13', 'L15H14', 'L15H15', 'L15H16', 'L15H17', 'L15H18', 'L15H19', 'L15H20', 'L15H21', 'L15H22', 'L15H23', 'L15H24', 'L15H25', 'L15H26', 'L15H27', 'L15H28', 'L15H29', 'L15H30', 'L15H31', '0_mlp_out', '1_mlp_out', '2_mlp_out', '3_mlp_out', '4_mlp_out', '5_mlp_out', '6_mlp_out', '7_mlp_out', '8_mlp_out', '9_mlp_out', '10_mlp_out', '11_mlp_out', '12_mlp_out', '13_mlp_out', '14_mlp_out', '15_mlp_out', 'embed', 'bias']
Map:   0%|          | 1/1373 [00:00<04:54,  4.66 examples/s]Map:   0%|          | 3/1373 [00:00<02:15, 10.12 examples/s]Map:   0%|          | 5/1373 [00:00<01:47, 12.71 examples/s]Map:   1%|          | 7/1373 [00:00<01:41, 13.45 examples/s]Map:   1%|          | 9/1373 [00:00<01:29, 15.19 examples/s]Map:   1%|          | 11/1373 [00:00<01:41, 13.40 examples/s]Map:   1%|          | 13/1373 [00:01<01:45, 12.94 examples/s]Map:   1%|          | 15/1373 [00:01<01:39, 13.71 examples/s]Map:   1%|          | 17/1373 [00:01<01:30, 14.97 examples/s]Map:   1%|▏         | 19/1373 [00:01<01:33, 14.55 examples/s]Map:   2%|▏         | 21/1373 [00:01<01:29, 15.17 examples/s]Map:   2%|▏         | 23/1373 [00:01<01:29, 15.12 examples/s]Map:   2%|▏         | 25/1373 [00:01<01:36, 13.97 examples/s]Map:   2%|▏         | 27/1373 [00:02<02:02, 11.02 examples/s]Map:   2%|▏         | 29/1373 [00:02<02:01, 11.09 examples/s]Map:   2%|▏         | 31/1373 [00:02<02:00, 11.11 examples/s]Map:   2%|▏         | 33/1373 [00:02<01:48, 12.35 examples/s]Map:   3%|▎         | 35/1373 [00:02<01:49, 12.22 examples/s]Map:   3%|▎         | 37/1373 [00:02<01:51, 11.97 examples/s]Map:   3%|▎         | 39/1373 [00:03<01:48, 12.30 examples/s]Map:   3%|▎         | 41/1373 [00:03<02:02, 10.85 examples/s]Map:   3%|▎         | 43/1373 [00:03<01:55, 11.55 examples/s]Map:   3%|▎         | 45/1373 [00:03<01:46, 12.44 examples/s]Map:   3%|▎         | 47/1373 [00:03<01:46, 12.47 examples/s]Map:   4%|▎         | 49/1373 [00:03<01:39, 13.37 examples/s]Map:   4%|▎         | 51/1373 [00:03<01:32, 14.37 examples/s]Map:   4%|▍         | 53/1373 [00:04<01:30, 14.59 examples/s]Map:   4%|▍         | 55/1373 [00:04<01:29, 14.66 examples/s]Map:   4%|▍         | 57/1373 [00:04<01:27, 15.03 examples/s]Map:   4%|▍         | 59/1373 [00:04<01:47, 12.20 examples/s]Map:   4%|▍         | 61/1373 [00:04<01:39, 13.16 examples/s]Map:   5%|▍         | 63/1373 [00:04<01:42, 12.81 examples/s]Map:   5%|▍         | 65/1373 [00:05<01:33, 14.03 examples/s]Map:   5%|▍         | 67/1373 [00:05<01:29, 14.62 examples/s]Map:   5%|▌         | 69/1373 [00:05<01:47, 12.15 examples/s]Map:   5%|▌         | 71/1373 [00:05<01:36, 13.46 examples/s]Map:   5%|▌         | 73/1373 [00:05<01:29, 14.56 examples/s]Map:   5%|▌         | 75/1373 [00:05<01:26, 15.00 examples/s]Map:   6%|▌         | 77/1373 [00:05<01:24, 15.31 examples/s]Map:   6%|▌         | 79/1373 [00:05<01:22, 15.60 examples/s]Map:   6%|▌         | 81/1373 [00:06<01:46, 12.09 examples/s]Map:   6%|▌         | 83/1373 [00:06<01:50, 11.71 examples/s]Map:   6%|▌         | 85/1373 [00:06<01:44, 12.35 examples/s]Map:   6%|▋         | 87/1373 [00:06<01:40, 12.76 examples/s]Map:   6%|▋         | 89/1373 [00:06<01:45, 12.16 examples/s]Map:   7%|▋         | 91/1373 [00:07<01:54, 11.23 examples/s]Map:   7%|▋         | 93/1373 [00:07<01:42, 12.53 examples/s]Map:   7%|▋         | 95/1373 [00:07<01:38, 13.00 examples/s]Map:   7%|▋         | 97/1373 [00:07<01:40, 12.71 examples/s]Map:   7%|▋         | 99/1373 [00:07<01:34, 13.52 examples/s]Map:   7%|▋         | 101/1373 [00:07<01:35, 13.27 examples/s]Map:   8%|▊         | 103/1373 [00:07<01:31, 13.83 examples/s]Map:   8%|▊         | 105/1373 [00:08<01:27, 14.53 examples/s]Map:   8%|▊         | 107/1373 [00:08<01:28, 14.28 examples/s]Map:   8%|▊         | 109/1373 [00:08<01:27, 14.52 examples/s]Map:   8%|▊         | 111/1373 [00:08<01:30, 14.00 examples/s]Map:   8%|▊         | 113/1373 [00:08<01:25, 14.78 examples/s]Map:   8%|▊         | 115/1373 [00:08<01:20, 15.58 examples/s]Map:   9%|▊         | 117/1373 [00:08<01:18, 15.93 examples/s]Map:   9%|▊         | 119/1373 [00:08<01:16, 16.43 examples/s]Map:   9%|▉         | 121/1373 [00:09<01:22, 15.14 examples/s]Map:   9%|▉         | 123/1373 [00:09<01:23, 14.96 examples/s]Map:   9%|▉         | 125/1373 [00:09<01:26, 14.40 examples/s]Map:   9%|▉         | 127/1373 [00:09<01:49, 11.37 examples/s]Map:   9%|▉         | 129/1373 [00:09<01:42, 12.13 examples/s]Map:  10%|▉         | 131/1373 [00:10<01:54, 10.84 examples/s]Map:  10%|▉         | 133/1373 [00:10<01:42, 12.12 examples/s]Map:  10%|▉         | 135/1373 [00:10<01:41, 12.22 examples/s]Map:  10%|▉         | 137/1373 [00:10<01:40, 12.31 examples/s]Map:  10%|█         | 139/1373 [00:10<01:38, 12.52 examples/s]Map:  10%|█         | 141/1373 [00:10<01:34, 13.03 examples/s]Map:  10%|█         | 143/1373 [00:10<01:30, 13.56 examples/s]Map:  11%|█         | 145/1373 [00:10<01:25, 14.34 examples/s]Map:  11%|█         | 147/1373 [00:11<01:25, 14.29 examples/s]Map:  11%|█         | 149/1373 [00:11<01:22, 14.82 examples/s]Map:  11%|█         | 151/1373 [00:11<01:23, 14.62 examples/s]Map:  11%|█         | 153/1373 [00:11<01:36, 12.65 examples/s]Map:  11%|█▏        | 155/1373 [00:11<01:33, 13.07 examples/s]Map:  11%|█▏        | 157/1373 [00:11<01:38, 12.32 examples/s]Map:  12%|█▏        | 159/1373 [00:12<01:40, 12.08 examples/s]Map:  12%|█▏        | 161/1373 [00:12<01:33, 12.97 examples/s]Map:  12%|█▏        | 163/1373 [00:12<01:29, 13.46 examples/s]Map:  12%|█▏        | 165/1373 [00:12<01:56, 10.33 examples/s]Map:  12%|█▏        | 167/1373 [00:12<01:43, 11.66 examples/s]Map:  12%|█▏        | 169/1373 [00:12<01:40, 11.92 examples/s]Map:  12%|█▏        | 171/1373 [00:13<01:32, 13.01 examples/s]Map:  13%|█▎        | 173/1373 [00:13<01:29, 13.42 examples/s]Map:  13%|█▎        | 175/1373 [00:13<01:31, 13.10 examples/s]Map:  13%|█▎        | 177/1373 [00:13<01:30, 13.17 examples/s]Map:  13%|█▎        | 179/1373 [00:13<02:01,  9.82 examples/s]Map:  13%|█▎        | 181/1373 [00:13<01:45, 11.30 examples/s]Map:  13%|█▎        | 183/1373 [00:14<01:36, 12.33 examples/s]Map:  13%|█▎        | 185/1373 [00:14<01:32, 12.85 examples/s]Map:  14%|█▎        | 187/1373 [00:14<01:35, 12.46 examples/s]Map:  14%|█▍        | 189/1373 [00:14<01:32, 12.83 examples/s]Map:  14%|█▍        | 191/1373 [00:14<01:29, 13.24 examples/s]Map:  14%|█▍        | 193/1373 [00:14<01:28, 13.26 examples/s]Map:  14%|█▍        | 195/1373 [00:14<01:25, 13.83 examples/s]Map:  14%|█▍        | 197/1373 [00:15<01:47, 10.95 examples/s]Map:  14%|█▍        | 199/1373 [00:15<01:47, 10.92 examples/s]Map:  15%|█▍        | 201/1373 [00:15<01:36, 12.15 examples/s]Map:  15%|█▍        | 203/1373 [00:15<01:39, 11.80 examples/s]Map:  15%|█▍        | 205/1373 [00:15<01:31, 12.77 examples/s]Map:  15%|█▌        | 207/1373 [00:15<01:25, 13.63 examples/s]Map:  15%|█▌        | 209/1373 [00:16<01:28, 13.21 examples/s]Map:  15%|█▌        | 211/1373 [00:16<01:25, 13.66 examples/s]Map:  16%|█▌        | 213/1373 [00:16<01:29, 12.95 examples/s]Map:  16%|█▌        | 215/1373 [00:16<01:23, 13.83 examples/s]Map:  16%|█▌        | 217/1373 [00:16<01:26, 13.42 examples/s]Map:  16%|█▌        | 219/1373 [00:16<01:28, 13.08 examples/s]Map:  16%|█▌        | 221/1373 [00:17<01:26, 13.35 examples/s]Map:  16%|█▌        | 223/1373 [00:17<01:32, 12.42 examples/s]Map:  16%|█▋        | 225/1373 [00:17<01:39, 11.57 examples/s]Map:  17%|█▋        | 227/1373 [00:17<02:00,  9.53 examples/s]Map:  17%|█▋        | 229/1373 [00:17<01:49, 10.49 examples/s]Map:  17%|█▋        | 231/1373 [00:17<01:37, 11.68 examples/s]Map:  17%|█▋        | 233/1373 [00:18<01:34, 12.01 examples/s]Map:  17%|█▋        | 235/1373 [00:18<01:27, 13.02 examples/s]Map:  17%|█▋        | 237/1373 [00:18<01:23, 13.66 examples/s]Map:  17%|█▋        | 239/1373 [00:18<01:29, 12.72 examples/s]Map:  18%|█▊        | 241/1373 [00:18<01:36, 11.70 examples/s]Map:  18%|█▊        | 243/1373 [00:18<01:38, 11.43 examples/s]Map:  18%|█▊        | 245/1373 [00:19<01:38, 11.43 examples/s]Map:  18%|█▊        | 247/1373 [00:19<01:35, 11.74 examples/s]Map:  18%|█▊        | 249/1373 [00:19<01:27, 12.91 examples/s]Map:  18%|█▊        | 251/1373 [00:19<01:28, 12.68 examples/s]Map:  18%|█▊        | 253/1373 [00:19<01:24, 13.23 examples/s]Map:  19%|█▊        | 255/1373 [00:19<01:22, 13.53 examples/s]Map:  19%|█▊        | 257/1373 [00:19<01:20, 13.92 examples/s]Map:  19%|█▉        | 259/1373 [00:20<01:20, 13.76 examples/s]Map:  19%|█▉        | 261/1373 [00:20<01:18, 14.11 examples/s]Map:  19%|█▉        | 263/1373 [00:20<01:20, 13.79 examples/s]Map:  19%|█▉        | 265/1373 [00:20<01:16, 14.48 examples/s]Map:  19%|█▉        | 267/1373 [00:20<01:16, 14.47 examples/s]Map:  20%|█▉        | 269/1373 [00:20<01:17, 14.21 examples/s]Map:  20%|█▉        | 271/1373 [00:20<01:15, 14.65 examples/s]Map:  20%|█▉        | 273/1373 [00:21<01:14, 14.67 examples/s]Map:  20%|██        | 275/1373 [00:21<01:18, 14.00 examples/s]Map:  20%|██        | 277/1373 [00:21<01:15, 14.56 examples/s]Map:  20%|██        | 279/1373 [00:21<01:12, 15.03 examples/s]Map:  20%|██        | 281/1373 [00:21<01:11, 15.35 examples/s]Map:  21%|██        | 283/1373 [00:21<01:33, 11.62 examples/s]Map:  21%|██        | 285/1373 [00:22<01:38, 11.00 examples/s]Map:  21%|██        | 287/1373 [00:22<01:29, 12.16 examples/s]Map:  21%|██        | 289/1373 [00:22<01:22, 13.09 examples/s]Map:  21%|██        | 291/1373 [00:22<01:35, 11.29 examples/s]Map:  21%|██▏       | 293/1373 [00:22<01:27, 12.39 examples/s]Map:  21%|██▏       | 295/1373 [00:22<01:22, 13.13 examples/s]Map:  22%|██▏       | 297/1373 [00:22<01:17, 13.80 examples/s]Map:  22%|██▏       | 299/1373 [00:23<01:16, 14.08 examples/s]Map:  22%|██▏       | 301/1373 [00:23<01:12, 14.77 examples/s]Map:  22%|██▏       | 303/1373 [00:23<01:22, 13.00 examples/s]Map:  22%|██▏       | 305/1373 [00:23<01:24, 12.65 examples/s]Map:  22%|██▏       | 307/1373 [00:23<01:26, 12.31 examples/s]Map:  23%|██▎       | 309/1373 [00:23<01:21, 13.03 examples/s]Map:  23%|██▎       | 311/1373 [00:24<01:21, 13.01 examples/s]Map:  23%|██▎       | 313/1373 [00:24<01:21, 13.04 examples/s]Map:  23%|██▎       | 315/1373 [00:24<01:19, 13.29 examples/s]Map:  23%|██▎       | 317/1373 [00:24<01:20, 13.09 examples/s]Map:  23%|██▎       | 319/1373 [00:24<01:16, 13.86 examples/s]Map:  23%|██▎       | 321/1373 [00:24<01:16, 13.70 examples/s]Map:  24%|██▎       | 323/1373 [00:24<01:14, 14.10 examples/s]Map:  24%|██▎       | 325/1373 [00:25<01:31, 11.42 examples/s]Map:  24%|██▍       | 327/1373 [00:25<01:26, 12.05 examples/s]Map:  24%|██▍       | 329/1373 [00:25<01:41, 10.32 examples/s]Map:  24%|██▍       | 331/1373 [00:25<02:00,  8.68 examples/s]Map:  24%|██▍       | 333/1373 [00:26<01:45,  9.83 examples/s]Map:  24%|██▍       | 335/1373 [00:26<01:35, 10.88 examples/s]Map:  25%|██▍       | 337/1373 [00:26<01:26, 11.91 examples/s]Map:  25%|██▍       | 339/1373 [00:26<01:41, 10.23 examples/s]Map:  25%|██▍       | 341/1373 [00:26<01:30, 11.42 examples/s]Map:  25%|██▍       | 343/1373 [00:26<01:23, 12.30 examples/s]Map:  25%|██▌       | 345/1373 [00:27<01:31, 11.21 examples/s]Map:  25%|██▌       | 347/1373 [00:27<01:24, 12.20 examples/s]Map:  25%|██▌       | 349/1373 [00:27<01:27, 11.76 examples/s]Map:  26%|██▌       | 351/1373 [00:27<01:36, 10.64 examples/s]Map:  26%|██▌       | 353/1373 [00:27<01:34, 10.84 examples/s]Map:  26%|██▌       | 355/1373 [00:27<01:37, 10.47 examples/s]Map:  26%|██▌       | 357/1373 [00:28<01:30, 11.27 examples/s]Map:  26%|██▌       | 359/1373 [00:28<01:23, 12.11 examples/s]Map:  26%|██▋       | 361/1373 [00:28<01:23, 12.07 examples/s]Map:  26%|██▋       | 363/1373 [00:28<01:23, 12.09 examples/s]Map:  27%|██▋       | 365/1373 [00:28<01:26, 11.68 examples/s]Map:  27%|██▋       | 367/1373 [00:29<01:47,  9.32 examples/s]Map:  27%|██▋       | 369/1373 [00:29<01:39, 10.12 examples/s]Map:  27%|██▋       | 371/1373 [00:29<01:39, 10.05 examples/s]Map:  27%|██▋       | 373/1373 [00:29<01:30, 11.05 examples/s]Map:  27%|██▋       | 375/1373 [00:29<01:28, 11.30 examples/s]Map:  27%|██▋       | 377/1373 [00:29<01:23, 11.99 examples/s]Map:  28%|██▊       | 379/1373 [00:30<01:21, 12.15 examples/s]Map:  28%|██▊       | 381/1373 [00:30<01:17, 12.72 examples/s]Map:  28%|██▊       | 383/1373 [00:30<01:47,  9.18 examples/s]Map:  28%|██▊       | 385/1373 [00:30<01:36, 10.27 examples/s]Map:  28%|██▊       | 387/1373 [00:30<01:36, 10.25 examples/s]Map:  28%|██▊       | 389/1373 [00:31<01:32, 10.61 examples/s]Map:  28%|██▊       | 391/1373 [00:31<01:24, 11.58 examples/s]Map:  29%|██▊       | 393/1373 [00:31<01:23, 11.71 examples/s]Map:  29%|██▉       | 395/1373 [00:31<01:19, 12.37 examples/s]Map:  29%|██▉       | 397/1373 [00:31<01:23, 11.69 examples/s]Map:  29%|██▉       | 399/1373 [00:31<01:23, 11.68 examples/s]Map:  29%|██▉       | 401/1373 [00:31<01:17, 12.52 examples/s]Map:  29%|██▉       | 403/1373 [00:32<01:16, 12.60 examples/s]Map:  29%|██▉       | 405/1373 [00:32<01:15, 12.78 examples/s]Map:  30%|██▉       | 407/1373 [00:32<01:12, 13.38 examples/s]Map:  30%|██▉       | 409/1373 [00:32<01:09, 13.79 examples/s]Map:  30%|██▉       | 411/1373 [00:32<01:23, 11.54 examples/s]Map:  30%|███       | 413/1373 [00:32<01:16, 12.49 examples/s]Map:  30%|███       | 415/1373 [00:33<01:15, 12.74 examples/s]Map:  30%|███       | 417/1373 [00:33<01:13, 13.05 examples/s]Map:  31%|███       | 419/1373 [00:33<01:11, 13.36 examples/s]Map:  31%|███       | 421/1373 [00:33<01:32, 10.31 examples/s]Map:  31%|███       | 423/1373 [00:33<01:23, 11.39 examples/s]Map:  31%|███       | 425/1373 [00:33<01:23, 11.41 examples/s]Map:  31%|███       | 427/1373 [00:34<01:32, 10.18 examples/s]Map:  31%|███       | 429/1373 [00:34<01:24, 11.20 examples/s]Map:  31%|███▏      | 431/1373 [00:34<01:18, 12.02 examples/s]Map:  32%|███▏      | 433/1373 [00:34<01:21, 11.51 examples/s]Map:  32%|███▏      | 435/1373 [00:34<01:15, 12.45 examples/s]Map:  32%|███▏      | 437/1373 [00:34<01:16, 12.28 examples/s]Map:  32%|███▏      | 439/1373 [00:35<01:10, 13.19 examples/s]Map:  32%|███▏      | 441/1373 [00:35<01:09, 13.51 examples/s]Map:  32%|███▏      | 443/1373 [00:35<01:06, 14.08 examples/s]Map:  32%|███▏      | 445/1373 [00:35<01:13, 12.70 examples/s]Map:  33%|███▎      | 447/1373 [00:35<01:09, 13.40 examples/s]Map:  33%|███▎      | 449/1373 [00:35<01:10, 13.19 examples/s]Map:  33%|███▎      | 451/1373 [00:35<01:08, 13.45 examples/s]Map:  33%|███▎      | 453/1373 [00:36<01:34,  9.76 examples/s]Map:  33%|███▎      | 455/1373 [00:36<01:27, 10.44 examples/s]Map:  33%|███▎      | 457/1373 [00:36<01:26, 10.64 examples/s]Map:  33%|███▎      | 459/1373 [00:36<01:18, 11.70 examples/s]Map:  34%|███▎      | 461/1373 [00:36<01:16, 11.88 examples/s]Map:  34%|███▎      | 463/1373 [00:37<01:11, 12.70 examples/s]Map:  34%|███▍      | 465/1373 [00:37<01:09, 12.99 examples/s]Map:  34%|███▍      | 467/1373 [00:37<01:09, 13.04 examples/s]Map:  34%|███▍      | 469/1373 [00:37<01:06, 13.58 examples/s]Map:  34%|███▍      | 471/1373 [00:37<01:15, 12.00 examples/s]Map:  34%|███▍      | 473/1373 [00:38<01:44,  8.63 examples/s]Map:  35%|███▍      | 475/1373 [00:38<01:36,  9.34 examples/s]Map:  35%|███▍      | 477/1373 [00:38<01:33,  9.60 examples/s]Map:  35%|███▍      | 479/1373 [00:38<01:28, 10.12 examples/s]Map:  35%|███▌      | 481/1373 [00:38<01:21, 11.00 examples/s]Map:  35%|███▌      | 483/1373 [00:38<01:16, 11.63 examples/s]Map:  35%|███▌      | 485/1373 [00:39<01:29,  9.90 examples/s]Map:  35%|███▌      | 487/1373 [00:39<01:21, 10.93 examples/s]Map:  36%|███▌      | 489/1373 [00:39<01:16, 11.60 examples/s]Map:  36%|███▌      | 491/1373 [00:39<01:13, 12.04 examples/s]Map:  36%|███▌      | 493/1373 [00:39<01:10, 12.52 examples/s]Map:  36%|███▌      | 495/1373 [00:39<01:10, 12.41 examples/s]Map:  36%|███▌      | 497/1373 [00:40<01:08, 12.86 examples/s]Map:  36%|███▋      | 499/1373 [00:40<01:11, 12.20 examples/s]Map:  36%|███▋      | 501/1373 [00:40<01:10, 12.35 examples/s]Map:  37%|███▋      | 503/1373 [00:40<01:14, 11.60 examples/s]Map:  37%|███▋      | 505/1373 [00:40<01:11, 12.19 examples/s]Map:  37%|███▋      | 507/1373 [00:40<01:07, 12.83 examples/s]Map:  37%|███▋      | 509/1373 [00:41<01:05, 13.14 examples/s]Map:  37%|███▋      | 511/1373 [00:41<01:08, 12.60 examples/s]Map:  37%|███▋      | 513/1373 [00:41<01:06, 12.86 examples/s]Map:  38%|███▊      | 515/1373 [00:41<01:08, 12.44 examples/s]Map:  38%|███▊      | 517/1373 [00:41<01:05, 13.08 examples/s]Map:  38%|███▊      | 519/1373 [00:41<01:09, 12.35 examples/s]Map:  38%|███▊      | 521/1373 [00:42<01:08, 12.53 examples/s]Map:  38%|███▊      | 523/1373 [00:42<01:04, 13.10 examples/s]Map:  38%|███▊      | 525/1373 [00:42<01:02, 13.58 examples/s]Map:  38%|███▊      | 527/1373 [00:42<01:02, 13.64 examples/s]Map:  39%|███▊      | 529/1373 [00:42<01:07, 12.45 examples/s]Map:  39%|███▊      | 531/1373 [00:42<01:04, 13.02 examples/s]Map:  39%|███▉      | 533/1373 [00:42<01:05, 12.86 examples/s]Map:  39%|███▉      | 535/1373 [00:43<01:03, 13.11 examples/s]Map:  39%|███▉      | 537/1373 [00:43<01:11, 11.62 examples/s]Map:  39%|███▉      | 539/1373 [00:43<01:07, 12.41 examples/s]Map:  39%|███▉      | 541/1373 [00:43<01:28,  9.45 examples/s]Map:  40%|███▉      | 543/1373 [00:43<01:19, 10.42 examples/s]Map:  40%|███▉      | 545/1373 [00:44<01:13, 11.23 examples/s]Map:  40%|███▉      | 547/1373 [00:44<01:14, 11.06 examples/s]Map:  40%|███▉      | 549/1373 [00:44<01:10, 11.69 examples/s]Map:  40%|████      | 551/1373 [00:44<01:08, 11.96 examples/s]Map:  40%|████      | 553/1373 [00:44<01:08, 12.01 examples/s]Map:  40%|████      | 555/1373 [00:44<01:06, 12.31 examples/s]Map:  41%|████      | 557/1373 [00:45<01:03, 12.75 examples/s]Map:  41%|████      | 559/1373 [00:45<01:04, 12.54 examples/s]Map:  41%|████      | 561/1373 [00:45<01:03, 12.81 examples/s]Map:  41%|████      | 563/1373 [00:45<01:00, 13.32 examples/s]Map:  41%|████      | 565/1373 [00:45<01:04, 12.53 examples/s]Map:  41%|████▏     | 567/1373 [00:45<01:02, 12.99 examples/s]Map:  41%|████▏     | 569/1373 [00:45<01:01, 13.02 examples/s]Map:  42%|████▏     | 571/1373 [00:46<00:59, 13.48 examples/s]Map:  42%|████▏     | 573/1373 [00:46<01:01, 13.11 examples/s]Map:  42%|████▏     | 575/1373 [00:46<01:08, 11.70 examples/s]Map:  42%|████▏     | 577/1373 [00:46<01:09, 11.53 examples/s]Map:  42%|████▏     | 579/1373 [00:46<01:10, 11.24 examples/s]Map:  42%|████▏     | 581/1373 [00:46<01:05, 12.08 examples/s]Map:  42%|████▏     | 583/1373 [00:47<01:02, 12.72 examples/s]Map:  43%|████▎     | 585/1373 [00:47<01:03, 12.48 examples/s]Map:  43%|████▎     | 587/1373 [00:47<01:01, 12.88 examples/s]Map:  43%|████▎     | 589/1373 [00:47<01:04, 12.16 examples/s]Map:  43%|████▎     | 591/1373 [00:47<01:03, 12.41 examples/s]Map:  43%|████▎     | 593/1373 [00:47<01:01, 12.73 examples/s]Map:  43%|████▎     | 595/1373 [00:48<01:14, 10.40 examples/s]Map:  43%|████▎     | 597/1373 [00:48<01:08, 11.29 examples/s]Map:  44%|████▎     | 599/1373 [00:48<01:13, 10.56 examples/s]Map:  44%|████▍     | 601/1373 [00:48<01:07, 11.48 examples/s]Map:  44%|████▍     | 603/1373 [00:48<01:06, 11.52 examples/s]Map:  44%|████▍     | 605/1373 [00:48<01:03, 12.12 examples/s]Map:  44%|████▍     | 607/1373 [00:49<01:01, 12.36 examples/s]Map:  44%|████▍     | 609/1373 [00:49<01:01, 12.41 examples/s]Map:  45%|████▍     | 611/1373 [00:49<01:01, 12.39 examples/s]Map:  45%|████▍     | 613/1373 [00:49<01:03, 12.00 examples/s]Map:  45%|████▍     | 615/1373 [00:49<01:07, 11.28 examples/s]Map:  45%|████▍     | 617/1373 [00:49<01:02, 12.04 examples/s]Map:  45%|████▌     | 619/1373 [00:50<01:02, 12.06 examples/s]Map:  45%|████▌     | 621/1373 [00:50<00:58, 12.79 examples/s]Map:  45%|████▌     | 623/1373 [00:50<01:01, 12.26 examples/s]Map:  46%|████▌     | 625/1373 [00:50<01:03, 11.81 examples/s]Map:  46%|████▌     | 627/1373 [00:50<00:59, 12.48 examples/s]Map:  46%|████▌     | 629/1373 [00:50<00:57, 13.05 examples/s]Map:  46%|████▌     | 631/1373 [00:51<00:58, 12.74 examples/s]Map:  46%|████▌     | 633/1373 [00:51<00:59, 12.50 examples/s]Map:  46%|████▌     | 635/1373 [00:51<01:00, 12.14 examples/s]Map:  46%|████▋     | 637/1373 [00:51<00:57, 12.88 examples/s]Map:  47%|████▋     | 639/1373 [00:51<00:55, 13.14 examples/s]Map:  47%|████▋     | 641/1373 [00:52<01:12, 10.09 examples/s]Map:  47%|████▋     | 643/1373 [00:52<01:07, 10.87 examples/s]Map:  47%|████▋     | 645/1373 [00:52<01:06, 10.88 examples/s]Map:  47%|████▋     | 647/1373 [00:52<01:08, 10.65 examples/s]Map:  47%|████▋     | 649/1373 [00:52<01:02, 11.62 examples/s]Map:  47%|████▋     | 651/1373 [00:52<00:59, 12.12 examples/s]Map:  48%|████▊     | 653/1373 [00:52<00:56, 12.67 examples/s]Map:  48%|████▊     | 655/1373 [00:53<00:54, 13.24 examples/s]Map:  48%|████▊     | 657/1373 [00:53<01:00, 11.89 examples/s]Map:  48%|████▊     | 659/1373 [00:53<01:03, 11.19 examples/s]Map:  48%|████▊     | 661/1373 [00:53<00:59, 11.92 examples/s]Map:  48%|████▊     | 663/1373 [00:53<00:59, 11.92 examples/s]Map:  48%|████▊     | 665/1373 [00:53<00:58, 12.13 examples/s]Map:  49%|████▊     | 667/1373 [00:54<01:04, 10.92 examples/s]Map:  49%|████▊     | 669/1373 [00:54<01:04, 10.92 examples/s]Map:  49%|████▉     | 671/1373 [00:54<00:59, 11.70 examples/s]Map:  49%|████▉     | 673/1373 [00:54<00:59, 11.75 examples/s]Map:  49%|████▉     | 675/1373 [00:54<01:11,  9.79 examples/s]Map:  49%|████▉     | 677/1373 [00:55<01:07, 10.27 examples/s]Map:  49%|████▉     | 679/1373 [00:55<01:20,  8.61 examples/s]Map:  50%|████▉     | 680/1373 [00:55<01:20,  8.65 examples/s]Map:  50%|████▉     | 682/1373 [00:55<01:12,  9.59 examples/s]Map:  50%|████▉     | 684/1373 [00:55<01:08, 10.11 examples/s]Map:  50%|████▉     | 686/1373 [00:56<01:04, 10.69 examples/s]Map:  50%|█████     | 688/1373 [00:56<01:02, 10.92 examples/s]Map:  50%|█████     | 690/1373 [00:56<01:02, 10.99 examples/s]Map:  50%|█████     | 692/1373 [00:56<01:05, 10.41 examples/s]Map:  51%|█████     | 694/1373 [00:56<01:00, 11.17 examples/s]Map:  51%|█████     | 696/1373 [00:56<00:59, 11.44 examples/s]Map:  51%|█████     | 698/1373 [00:57<00:55, 12.09 examples/s]Map:  51%|█████     | 700/1373 [00:57<00:58, 11.53 examples/s]Map:  51%|█████     | 702/1373 [00:57<01:03, 10.55 examples/s]Map:  51%|█████▏    | 704/1373 [00:57<01:01, 10.83 examples/s]Map:  51%|█████▏    | 706/1373 [00:57<01:02, 10.75 examples/s]Map:  52%|█████▏    | 708/1373 [00:58<00:58, 11.39 examples/s]Map:  52%|█████▏    | 710/1373 [00:58<01:13,  9.07 examples/s]Map:  52%|█████▏    | 712/1373 [00:58<01:06,  9.93 examples/s]Map:  52%|█████▏    | 714/1373 [00:58<01:02, 10.60 examples/s]Map:  52%|█████▏    | 716/1373 [00:58<01:00, 10.92 examples/s]Map:  52%|█████▏    | 718/1373 [00:59<00:56, 11.58 examples/s]Map:  52%|█████▏    | 720/1373 [00:59<00:55, 11.81 examples/s]Map:  53%|█████▎    | 722/1373 [00:59<00:56, 11.47 examples/s]Map:  53%|█████▎    | 724/1373 [00:59<00:54, 11.84 examples/s]Map:  53%|█████▎    | 726/1373 [00:59<00:58, 11.13 examples/s]Map:  53%|█████▎    | 728/1373 [00:59<00:55, 11.63 examples/s]Map:  53%|█████▎    | 730/1373 [01:00<00:57, 11.28 examples/s]Map:  53%|█████▎    | 732/1373 [01:00<00:54, 11.83 examples/s]Map:  53%|█████▎    | 734/1373 [01:00<00:54, 11.76 examples/s]Map:  54%|█████▎    | 736/1373 [01:00<00:58, 10.89 examples/s]Map:  54%|█████▍    | 738/1373 [01:00<01:05,  9.74 examples/s]Map:  54%|█████▍    | 740/1373 [01:01<00:59, 10.64 examples/s]Map:  54%|█████▍    | 742/1373 [01:01<01:11,  8.82 examples/s]Map:  54%|█████▍    | 744/1373 [01:01<01:04,  9.73 examples/s]Map:  54%|█████▍    | 746/1373 [01:01<01:00, 10.35 examples/s]Map:  54%|█████▍    | 748/1373 [01:01<00:56, 11.15 examples/s]Map:  55%|█████▍    | 750/1373 [01:01<00:53, 11.64 examples/s]Map:  55%|█████▍    | 752/1373 [01:02<00:53, 11.52 examples/s]Map:  55%|█████▍    | 754/1373 [01:02<00:54, 11.44 examples/s]Map:  55%|█████▌    | 756/1373 [01:02<00:54, 11.33 examples/s]Map:  55%|█████▌    | 758/1373 [01:02<00:58, 10.50 examples/s]Map:  55%|█████▌    | 760/1373 [01:02<00:58, 10.51 examples/s]Map:  55%|█████▌    | 762/1373 [01:03<00:58, 10.39 examples/s]Map:  56%|█████▌    | 764/1373 [01:03<00:57, 10.55 examples/s]Map:  56%|█████▌    | 766/1373 [01:03<00:59, 10.19 examples/s]Map:  56%|█████▌    | 768/1373 [01:03<00:57, 10.52 examples/s]Map:  56%|█████▌    | 770/1373 [01:03<00:53, 11.24 examples/s]Map:  56%|█████▌    | 772/1373 [01:04<00:54, 10.96 examples/s]Map:  56%|█████▋    | 774/1373 [01:04<00:52, 11.50 examples/s]Map:  57%|█████▋    | 776/1373 [01:04<00:51, 11.56 examples/s]Map:  57%|█████▋    | 778/1373 [01:04<00:49, 11.94 examples/s]Map:  57%|█████▋    | 780/1373 [01:04<00:48, 12.30 examples/s]Map:  57%|█████▋    | 782/1373 [01:04<00:55, 10.74 examples/s]Map:  57%|█████▋    | 784/1373 [01:05<00:56, 10.46 examples/s]Map:  57%|█████▋    | 786/1373 [01:05<01:01,  9.55 examples/s]Map:  57%|█████▋    | 788/1373 [01:05<00:56, 10.34 examples/s]Map:  58%|█████▊    | 790/1373 [01:05<01:00,  9.61 examples/s]Map:  58%|█████▊    | 792/1373 [01:05<00:58,  9.91 examples/s]Map:  58%|█████▊    | 794/1373 [01:06<00:58,  9.81 examples/s]Map:  58%|█████▊    | 796/1373 [01:06<00:53, 10.75 examples/s]Map:  58%|█████▊    | 798/1373 [01:06<01:02,  9.26 examples/s]Map:  58%|█████▊    | 800/1373 [01:06<00:55, 10.23 examples/s]Map:  58%|█████▊    | 802/1373 [01:06<00:55, 10.33 examples/s]Map:  59%|█████▊    | 804/1373 [01:07<00:55, 10.27 examples/s]Map:  59%|█████▊    | 806/1373 [01:07<00:53, 10.62 examples/s]Map:  59%|█████▉    | 808/1373 [01:07<00:53, 10.61 examples/s]Map:  59%|█████▉    | 810/1373 [01:07<00:49, 11.44 examples/s]Map:  59%|█████▉    | 812/1373 [01:07<00:54, 10.30 examples/s]Map:  59%|█████▉    | 814/1373 [01:07<00:50, 11.18 examples/s]Map:  59%|█████▉    | 816/1373 [01:08<00:48, 11.39 examples/s]Map:  60%|█████▉    | 818/1373 [01:08<00:48, 11.36 examples/s]Map:  60%|█████▉    | 820/1373 [01:08<00:47, 11.68 examples/s]Map:  60%|█████▉    | 822/1373 [01:08<00:46, 11.79 examples/s]Map:  60%|█████▉    | 823/1373 [01:09<00:46, 11.92 examples/s]
Traceback (most recent call last):
  File "/home/g/grimmj/IdiomHeads/compute_logit_attr.py", line 47, in <module>
    data.map(lambda batch: scorer.compute_logit_attr_batched(batch, grouped_file), batched=True, batch_size = batch_size)
  File "/home/g/grimmj/miniconda3/envs/idiom/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 562, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
                                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/g/grimmj/miniconda3/envs/idiom/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 3079, in map
    for rank, done, content in Dataset._map_single(**dataset_kwargs):
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/g/grimmj/miniconda3/envs/idiom/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 3519, in _map_single
    for i, batch in iter_outputs(shard_iterable):
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/g/grimmj/miniconda3/envs/idiom/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 3469, in iter_outputs
    yield i, apply_function(example, i, offset=offset)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/g/grimmj/miniconda3/envs/idiom/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 3392, in apply_function
    processed_inputs = function(*fn_args, *additional_args, **fn_kwargs)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/g/grimmj/IdiomHeads/compute_logit_attr.py", line 47, in <lambda>
    data.map(lambda batch: scorer.compute_logit_attr_batched(batch, grouped_file), batched=True, batch_size = batch_size)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/g/grimmj/IdiomHeads/logit_attribution.py", line 110, in compute_logit_attr_batched
    sent_score = self.compute_logit_attr(batch["sentence"][i])
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/g/grimmj/IdiomHeads/logit_attribution.py", line 94, in compute_logit_attr
    logit_attr = self.logit_attrs(tokens, has_batch_dim=False)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/g/grimmj/IdiomHeads/logit_attribution.py", line 234, in logit_attrs
    logit_attrs = (scaled_residual_stack * logit_directions).sum(dim=-1)
                   ~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 950.00 MiB. GPU 0 has a total capacity of 7.60 GiB of which 849.88 MiB is free. Including non-PyTorch memory, this process has 6.76 GiB memory in use. Of the allocated memory 5.71 GiB is allocated by PyTorch, and 955.46 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
