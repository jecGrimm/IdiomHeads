slurmstepd-aplit: error: Unable to create TMPDIR [/tmp/user/32202]: Permission denied
slurmstepd-aplit: error: Setting TMPDIR to /tmp
/home/g/grimmj/miniconda3/envs/idiom/lib/python3.12/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
WARNING:root:With reduced precision, it is advised to use `from_pretrained_no_processing` instead of `from_pretrained`.
Loaded pretrained model EleutherAI/pythia-1.4b into HookedTransformer
Running compute_idiom_only on device cuda.

Processing split:  static
Map:   0%|          | 0/21890 [00:00<?, ? examples/s]Map:   0%|          | 81/21890 [00:00<00:27, 794.28 examples/s]Map:   1%|          | 168/21890 [00:00<00:26, 817.78 examples/s]Map:   1%|          | 263/21890 [00:00<00:24, 870.69 examples/s]Map:   2%|▏         | 351/21890 [00:00<00:24, 869.10 examples/s]Map:   2%|▏         | 448/21890 [00:00<00:23, 904.63 examples/s]Map:   2%|▏         | 547/21890 [00:00<00:23, 927.87 examples/s]Map:   3%|▎         | 655/21890 [00:00<00:25, 819.34 examples/s]Map:   3%|▎         | 744/21890 [00:00<00:25, 835.54 examples/s]Map:   4%|▍         | 831/21890 [00:00<00:24, 843.99 examples/s]Map:   4%|▍         | 958/21890 [00:01<00:24, 842.73 examples/s]Map:   5%|▍         | 1050/21890 [00:01<00:24, 860.72 examples/s]Map:   5%|▌         | 1167/21890 [00:01<00:25, 828.67 examples/s]Map:   6%|▌         | 1252/21890 [00:01<00:24, 830.18 examples/s]Map:   6%|▌         | 1342/21890 [00:01<00:24, 845.73 examples/s]Map:   7%|▋         | 1439/21890 [00:01<00:23, 878.10 examples/s]Map:   7%|▋         | 1564/21890 [00:01<00:23, 857.95 examples/s]Map:   8%|▊         | 1679/21890 [00:01<00:24, 822.02 examples/s]Map:   8%|▊         | 1766/21890 [00:02<00:24, 831.68 examples/s]Map:   9%|▊         | 1896/21890 [00:02<00:23, 840.49 examples/s]Map:   9%|▉         | 2020/21890 [00:02<00:23, 831.96 examples/s]Map:  10%|▉         | 2104/21890 [00:02<00:23, 832.85 examples/s]Map:  10%|█         | 2229/21890 [00:02<00:23, 829.51 examples/s]Map:  11%|█         | 2355/21890 [00:02<00:23, 830.46 examples/s]Map:  11%|█▏        | 2470/21890 [00:02<00:24, 804.40 examples/s]Map:  12%|█▏        | 2578/21890 [00:03<00:24, 775.32 examples/s]Map:  12%|█▏        | 2661/21890 [00:03<00:24, 783.28 examples/s]Map:  13%|█▎        | 2744/21890 [00:03<00:24, 791.43 examples/s]Map:  13%|█▎        | 2830/21890 [00:03<00:23, 806.33 examples/s]Map:  13%|█▎        | 2928/21890 [00:03<00:22, 852.12 examples/s]Map:  14%|█▍        | 3024/21890 [00:03<00:21, 879.17 examples/s]Map:  14%|█▍        | 3142/21890 [00:03<00:22, 840.04 examples/s]Map:  15%|█▍        | 3261/21890 [00:03<00:22, 819.01 examples/s]Map:  15%|█▌        | 3371/21890 [00:04<00:23, 783.17 examples/s]Map:  16%|█▌        | 3464/21890 [00:04<00:25, 727.27 examples/s]Map:  16%|█▋        | 3563/21890 [00:04<00:25, 705.18 examples/s]Map:  17%|█▋        | 3661/21890 [00:04<00:26, 687.78 examples/s]Map:  17%|█▋        | 3758/21890 [00:04<00:26, 672.08 examples/s]Map:  18%|█▊        | 3855/21890 [00:04<00:27, 660.66 examples/s]Map:  18%|█▊        | 3953/21890 [00:04<00:27, 654.35 examples/s]Map:  18%|█▊        | 4026/21890 [00:05<00:26, 669.49 examples/s]Map:  19%|█▊        | 4094/21890 [00:05<00:26, 670.23 examples/s]Map:  19%|█▉        | 4170/21890 [00:05<00:25, 688.94 examples/s]Map:  19%|█▉        | 4242/21890 [00:05<00:25, 693.20 examples/s]Map:  20%|█▉        | 4313/21890 [00:05<00:25, 695.33 examples/s]Map:  20%|██        | 4393/21890 [00:05<00:24, 722.98 examples/s]Map:  20%|██        | 4469/21890 [00:05<00:23, 730.25 examples/s]Map:  21%|██        | 4578/21890 [00:05<00:23, 725.11 examples/s]Map:  21%|██▏       | 4655/21890 [00:05<00:23, 731.39 examples/s]Map:  22%|██▏       | 4729/21890 [00:06<00:23, 728.02 examples/s]Map:  22%|██▏       | 4803/21890 [00:06<00:23, 730.07 examples/s]Map:  22%|██▏       | 4910/21890 [00:06<00:23, 720.90 examples/s]Map:  23%|██▎       | 5023/21890 [00:06<00:23, 728.02 examples/s]Map:  23%|██▎       | 5105/21890 [00:06<00:22, 745.79 examples/s]Map:  24%|██▎       | 5189/21890 [00:06<00:21, 764.24 examples/s]Map:  24%|██▍       | 5299/21890 [00:06<00:22, 749.57 examples/s]Map:  25%|██▍       | 5414/21890 [00:06<00:21, 753.64 examples/s]Map:  25%|██▌       | 5500/21890 [00:07<00:21, 777.90 examples/s]Map:  26%|██▌       | 5611/21890 [00:07<00:21, 761.02 examples/s]Map:  26%|██▌       | 5692/21890 [00:07<00:21, 768.97 examples/s]Map:  27%|██▋       | 5803/21890 [00:07<00:21, 754.82 examples/s]Map:  27%|██▋       | 5920/21890 [00:07<00:21, 758.04 examples/s]Map:  28%|██▊       | 6026/21890 [00:07<00:21, 738.16 examples/s]Map:  28%|██▊       | 6113/21890 [00:07<00:20, 764.29 examples/s]Map:  28%|██▊       | 6201/21890 [00:07<00:19, 790.26 examples/s]Map:  29%|██▉       | 6313/21890 [00:08<00:20, 771.47 examples/s]Map:  29%|██▉       | 6412/21890 [00:08<00:21, 730.87 examples/s]Map:  30%|██▉       | 6524/21890 [00:08<00:20, 732.92 examples/s]Map:  30%|███       | 6623/21890 [00:08<00:21, 706.91 examples/s]Map:  31%|███       | 6725/21890 [00:08<00:21, 694.59 examples/s]Map:  31%|███       | 6806/21890 [00:08<00:21, 717.01 examples/s]Map:  31%|███▏      | 6888/21890 [00:08<00:20, 740.44 examples/s]Map:  32%|███▏      | 6966/21890 [00:09<00:19, 749.51 examples/s]Map:  32%|███▏      | 7048/21890 [00:09<00:19, 767.05 examples/s]Map:  33%|███▎      | 7140/21890 [00:09<00:18, 807.10 examples/s]Map:  33%|███▎      | 7227/21890 [00:09<00:17, 822.33 examples/s]Map:  33%|███▎      | 7319/21890 [00:09<00:17, 843.87 examples/s]Map:  34%|███▍      | 7411/21890 [00:09<00:16, 858.96 examples/s]Map:  34%|███▍      | 7512/21890 [00:09<00:16, 898.22 examples/s]Map:  35%|███▍      | 7608/21890 [00:09<00:15, 912.42 examples/s]Map:  35%|███▌      | 7702/21890 [00:09<00:15, 912.95 examples/s]Map:  36%|███▌      | 7798/21890 [00:09<00:15, 923.51 examples/s]Map:  36%|███▌      | 7933/21890 [00:10<00:15, 911.95 examples/s]Map:  37%|███▋      | 8030/21890 [00:10<00:14, 924.89 examples/s]Map:  37%|███▋      | 8167/21890 [00:10<00:14, 917.76 examples/s]Map:  38%|███▊      | 8302/21890 [00:10<00:15, 904.33 examples/s]Map:  38%|███▊      | 8393/21890 [00:10<00:14, 901.02 examples/s]Map:  39%|███▉      | 8523/21890 [00:10<00:15, 885.44 examples/s]Map:  39%|███▉      | 8620/21890 [00:10<00:14, 903.63 examples/s]Map:  40%|███▉      | 8740/21890 [00:11<00:15, 866.82 examples/s]Map:  41%|████      | 8866/21890 [00:11<00:15, 855.07 examples/s]Map:  41%|████      | 8989/21890 [00:11<00:15, 840.17 examples/s]Map:  42%|████▏     | 9108/21890 [00:11<00:15, 823.78 examples/s]Map:  42%|████▏     | 9224/21890 [00:11<00:15, 804.04 examples/s]Map:  43%|████▎     | 9312/21890 [00:11<00:15, 818.51 examples/s]Map:  43%|████▎     | 9424/21890 [00:11<00:15, 793.54 examples/s]Map:  44%|████▎     | 9528/21890 [00:12<00:16, 753.85 examples/s]Map:  44%|████▍     | 9618/21890 [00:12<00:17, 703.90 examples/s]Map:  44%|████▍     | 9712/21890 [00:12<00:17, 678.71 examples/s]Map:  45%|████▍     | 9783/21890 [00:12<00:18, 671.05 examples/s]Map:  45%|████▌     | 9858/21890 [00:12<00:17, 687.49 examples/s]Map:  45%|████▌     | 9937/21890 [00:12<00:16, 712.14 examples/s]Map:  46%|████▌     | 10010/21890 [00:12<00:16, 716.05 examples/s]Map:  46%|████▌     | 10088/21890 [00:12<00:16, 729.21 examples/s]Map:  46%|████▋     | 10162/21890 [00:12<00:16, 728.82 examples/s]Map:  47%|████▋     | 10243/21890 [00:13<00:15, 749.95 examples/s]Map:  47%|████▋     | 10320/21890 [00:13<00:15, 752.94 examples/s]Map:  48%|████▊     | 10401/21890 [00:13<00:15, 765.89 examples/s]Map:  48%|████▊     | 10481/21890 [00:13<00:14, 774.47 examples/s]Map:  48%|████▊     | 10565/21890 [00:13<00:14, 793.37 examples/s]Map:  49%|████▊     | 10659/21890 [00:13<00:13, 835.39 examples/s]Map:  49%|████▉     | 10743/21890 [00:13<00:13, 834.30 examples/s]Map:  50%|████▉     | 10858/21890 [00:13<00:13, 805.59 examples/s]Map:  50%|█████     | 10973/21890 [00:13<00:13, 786.17 examples/s]Map:  51%|█████     | 11056/21890 [00:14<00:13, 795.10 examples/s]Map:  51%|█████     | 11166/21890 [00:14<00:13, 769.04 examples/s]Map:  51%|█████▏    | 11253/21890 [00:14<00:13, 791.57 examples/s]Map:  52%|█████▏    | 11338/21890 [00:14<00:13, 803.38 examples/s]Map:  52%|█████▏    | 11428/21890 [00:14<00:12, 824.78 examples/s]Map:  53%|█████▎    | 11526/21890 [00:14<00:13, 755.91 examples/s]Map:  53%|█████▎    | 11632/21890 [00:14<00:13, 735.61 examples/s]Map:  54%|█████▎    | 11729/21890 [00:14<00:14, 699.01 examples/s]Map:  54%|█████▍    | 11835/21890 [00:15<00:14, 698.41 examples/s]Map:  54%|█████▍    | 11930/21890 [00:15<00:13, 755.26 examples/s]Map:  55%|█████▍    | 12032/21890 [00:15<00:13, 725.55 examples/s]Map:  55%|█████▌    | 12118/21890 [00:15<00:12, 755.81 examples/s]Map:  56%|█████▌    | 12196/21890 [00:15<00:12, 757.29 examples/s]Map:  56%|█████▌    | 12312/21890 [00:15<00:12, 760.29 examples/s]Map:  57%|█████▋    | 12412/21890 [00:15<00:13, 720.73 examples/s]Map:  57%|█████▋    | 12518/21890 [00:16<00:13, 713.04 examples/s]Map:  58%|█████▊    | 12604/21890 [00:16<00:12, 742.65 examples/s]Map:  58%|█████▊    | 12682/21890 [00:16<00:12, 748.81 examples/s]Map:  58%|█████▊    | 12769/21890 [00:16<00:11, 779.20 examples/s]Map:  59%|█████▉    | 12892/21890 [00:16<00:11, 787.51 examples/s]Map:  59%|█████▉    | 13005/21890 [00:16<00:11, 769.86 examples/s]Map:  60%|█████▉    | 13106/21890 [00:16<00:12, 731.21 examples/s]Map:  60%|██████    | 13181/21890 [00:16<00:11, 733.01 examples/s]Map:  61%|██████    | 13256/21890 [00:17<00:11, 731.64 examples/s]Map:  61%|██████    | 13365/21890 [00:17<00:11, 722.88 examples/s]Map:  61%|██████▏   | 13454/21890 [00:17<00:11, 760.74 examples/s]Map:  62%|██████▏   | 13539/21890 [00:17<00:10, 782.56 examples/s]Map:  62%|██████▏   | 13628/21890 [00:17<00:10, 811.42 examples/s]Map:  63%|██████▎   | 13748/21890 [00:17<00:10, 806.06 examples/s]Map:  63%|██████▎   | 13869/21890 [00:17<00:10, 800.50 examples/s]Map:  64%|██████▍   | 13959/21890 [00:17<00:09, 821.35 examples/s]Map:  64%|██████▍   | 14046/21890 [00:17<00:09, 829.14 examples/s]Map:  65%|██████▍   | 14168/21890 [00:18<00:09, 814.61 examples/s]Map:  65%|██████▌   | 14254/21890 [00:18<00:09, 824.51 examples/s]Map:  66%|██████▌   | 14374/21890 [00:18<00:09, 813.01 examples/s]Map:  66%|██████▌   | 14456/21890 [00:18<00:09, 810.23 examples/s]Map:  66%|██████▋   | 14542/21890 [00:18<00:08, 821.77 examples/s]Map:  67%|██████▋   | 14647/21890 [00:18<00:09, 765.34 examples/s]Map:  67%|██████▋   | 14759/21890 [00:18<00:09, 757.55 examples/s]Map:  68%|██████▊   | 14873/21890 [00:19<00:09, 754.57 examples/s]Map:  68%|██████▊   | 14957/21890 [00:19<00:08, 773.75 examples/s]Map:  69%|██████▉   | 15072/21890 [00:19<00:08, 764.01 examples/s]Map:  69%|██████▉   | 15160/21890 [00:19<00:08, 781.41 examples/s]Map:  70%|██████▉   | 15274/21890 [00:19<00:08, 769.06 examples/s]Map:  70%|███████   | 15362/21890 [00:19<00:08, 793.86 examples/s]Map:  71%|███████   | 15448/21890 [00:19<00:07, 809.75 examples/s]Map:  71%|███████   | 15539/21890 [00:19<00:07, 832.98 examples/s]Map:  71%|███████▏  | 15638/21890 [00:20<00:08, 763.83 examples/s]Map:  72%|███████▏  | 15745/21890 [00:20<00:08, 740.68 examples/s]Map:  72%|███████▏  | 15850/21890 [00:20<00:08, 723.75 examples/s]Map:  73%|███████▎  | 15958/21890 [00:20<00:08, 719.20 examples/s]Map:  73%|███████▎  | 16044/21890 [00:20<00:07, 749.34 examples/s]Map:  74%|███████▍  | 16159/21890 [00:20<00:07, 746.63 examples/s]Map:  74%|███████▍  | 16280/21890 [00:20<00:07, 763.68 examples/s]Map:  75%|███████▍  | 16382/21890 [00:20<00:06, 822.39 examples/s]Map:  75%|███████▌  | 16483/21890 [00:21<00:06, 866.68 examples/s]Map:  76%|███████▌  | 16573/21890 [00:21<00:06, 868.58 examples/s]Map:  76%|███████▋  | 16699/21890 [00:21<00:06, 853.21 examples/s]Map:  77%|███████▋  | 16813/21890 [00:21<00:06, 819.30 examples/s]Map:  77%|███████▋  | 16934/21890 [00:21<00:06, 812.48 examples/s]Map:  78%|███████▊  | 17030/21890 [00:21<00:05, 844.58 examples/s]Map:  78%|███████▊  | 17149/21890 [00:21<00:05, 823.49 examples/s]Map:  79%|███████▉  | 17248/21890 [00:22<00:06, 768.38 examples/s]Map:  79%|███████▉  | 17346/21890 [00:22<00:06, 726.58 examples/s]Map:  80%|███████▉  | 17434/21890 [00:22<00:06, 678.04 examples/s]Map:  80%|████████  | 17531/21890 [00:22<00:06, 666.75 examples/s]Map:  80%|████████  | 17608/21890 [00:22<00:06, 688.32 examples/s]Map:  81%|████████  | 17691/21890 [00:22<00:05, 720.78 examples/s]Map:  81%|████████  | 17774/21890 [00:22<00:05, 746.72 examples/s]Map:  82%|████████▏ | 17854/21890 [00:22<00:05, 759.80 examples/s]Map:  82%|████████▏ | 17937/21890 [00:23<00:05, 776.05 examples/s]Map:  82%|████████▏ | 18024/21890 [00:23<00:04, 799.18 examples/s]Map:  83%|████████▎ | 18109/21890 [00:23<00:04, 811.33 examples/s]Map:  83%|████████▎ | 18208/21890 [00:23<00:04, 749.97 examples/s]Map:  84%|████████▎ | 18286/21890 [00:23<00:04, 750.83 examples/s]Map:  84%|████████▍ | 18369/21890 [00:23<00:04, 766.91 examples/s]Map:  84%|████████▍ | 18451/21890 [00:23<00:04, 779.54 examples/s]Map:  85%|████████▍ | 18536/21890 [00:23<00:04, 796.62 examples/s]Map:  85%|████████▌ | 18621/21890 [00:23<00:04, 809.05 examples/s]Map:  85%|████████▌ | 18705/21890 [00:23<00:03, 816.73 examples/s]Map:  86%|████████▌ | 18812/21890 [00:24<00:03, 774.43 examples/s]Map:  86%|████████▋ | 18924/21890 [00:24<00:03, 761.49 examples/s]Map:  87%|████████▋ | 19008/21890 [00:24<00:03, 779.33 examples/s]Map:  87%|████████▋ | 19091/21890 [00:24<00:03, 787.86 examples/s]Map:  88%|████████▊ | 19173/21890 [00:24<00:03, 793.33 examples/s]Map:  88%|████████▊ | 19254/21890 [00:24<00:03, 794.06 examples/s]Map:  88%|████████▊ | 19369/21890 [00:24<00:03, 779.01 examples/s]Map:  89%|████████▉ | 19449/21890 [00:24<00:03, 782.43 examples/s]Map:  89%|████████▉ | 19529/21890 [00:25<00:03, 782.28 examples/s]Map:  90%|████████▉ | 19651/21890 [00:25<00:02, 786.88 examples/s]Map:  90%|█████████ | 19765/21890 [00:25<00:02, 763.97 examples/s]Map:  91%|█████████ | 19851/21890 [00:25<00:02, 786.91 examples/s]Map:  91%|█████████ | 19942/21890 [00:25<00:02, 813.90 examples/s]Map:  91%|█████████▏| 20027/21890 [00:25<00:02, 821.36 examples/s]Map:  92%|█████████▏| 20154/21890 [00:25<00:02, 826.94 examples/s]Map:  92%|█████████▏| 20240/21890 [00:25<00:01, 832.92 examples/s]Map:  93%|█████████▎| 20362/21890 [00:26<00:01, 821.41 examples/s]Map:  94%|█████████▎| 20478/21890 [00:26<00:01, 798.11 examples/s]Map:  94%|█████████▍| 20559/21890 [00:26<00:01, 797.47 examples/s]Map:  94%|█████████▍| 20646/21890 [00:26<00:01, 813.72 examples/s]Map:  95%|█████████▍| 20733/21890 [00:26<00:01, 805.08 examples/s]Map:  95%|█████████▌| 20814/21890 [00:26<00:01, 804.05 examples/s]Map:  95%|█████████▌| 20901/21890 [00:26<00:01, 820.36 examples/s]Map:  96%|█████████▌| 21014/21890 [00:26<00:01, 792.19 examples/s]Map:  96%|█████████▋| 21096/21890 [00:26<00:00, 796.86 examples/s]Map:  97%|█████████▋| 21180/21890 [00:27<00:00, 805.48 examples/s]Map:  97%|█████████▋| 21296/21890 [00:27<00:00, 788.00 examples/s]Map:  98%|█████████▊| 21421/21890 [00:27<00:00, 801.90 examples/s]Map:  98%|█████████▊| 21511/21890 [00:27<00:00, 821.86 examples/s]Map:  99%|█████████▊| 21594/21890 [00:27<00:00, 817.99 examples/s]Map:  99%|█████████▉| 21677/21890 [00:27<00:00, 819.99 examples/s]Map: 100%|█████████▉| 21793/21890 [00:27<00:00, 799.04 examples/s]Map: 100%|██████████| 21890/21890 [00:27<00:00, 773.48 examples/s]Map: 100%|██████████| 21890/21890 [00:27<00:00, 782.00 examples/s]
start: 655, end: 2761, len idiom_pos: 2106, len data: 21890
Traceback (most recent call last):
  File "/home/g/grimmj/IdiomHeads/compute_idiom_only.py", line 56, in <module>
    data[start:end].map(lambda batch: scorer.create_idiom_score_tensor(batch, comp_file), batched=True, batch_size = batch_size)
    ^^^^^^^^^^^^^^^^^^^
AttributeError: 'dict' object has no attribute 'map'
